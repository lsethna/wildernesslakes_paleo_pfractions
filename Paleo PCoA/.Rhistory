#will replace NA values with interpolated values - done at every dated interval
mutate_at(vars(ast_formosa:b_car),funs(zoo::na.approx(.,method="constant",rule=2))) %>% #rule=2 means extend nearest values to leading/trailing NAs
ungroup() %>%
drop_na() #remove any NA values - beyond dated intervals
View(master_v3_interp)
#quick check to make sure all dates and dates are included
ggplot(master_v3_interp,aes(x=year_loess,y=depth))+
geom_line()+facet_wrap(~lake)
glimpse(master_v3_interp)
colnames(master_v3_interp)
#standardize diatoms
diat.stand.hell <- vegan::decostand(master_v3_interp[,4:29], method="hellinger")
#diatom distance matrix
diat.dist <- dist(diat.stand.hell, method="euclidean")
#normalize the diatom vectors to allow for comparison across proxies
diat.dist <- diat.dist/max(diat.dist)
#standardize pigments
pig.stand.hell <- decostand(master_v3_interp[,30:41], method="hellinger")
#pigment distance matrix
pig.dist <- dist(pig.stand.hell, method="euclidean")
pig.dist <- pig.dist/max(pig.dist)
#combine distance matrices
comb.dist <- diat.dist+pig.dist#+geochem.dist
#and scale
comb.mds <- cmdscale(d = comb.dist, k = 2, eig = TRUE)
#extract site scores
comb.scores <- as.data.frame(comb.mds$points)
eigs <- comb.mds$eig
var1 <- round((eigs[1] / sum(eigs[eigs > 0])) * 100, 1)
var2 <- round((eigs[2] / sum(eigs[eigs > 0])) * 100, 1)
cat("Axis 1 =", var1, "%, Axis 2 =", var2, "% of total variance\n")
comb.mds <- cmdscale(d = comb.dist, k = 2)
plot(comb.mds)
#get scores
site.comb <- data.frame(scores(comb.mds))
#add sample IDs
site.comb$lake <- master_v3_interp$lake
site.comb$year <- master_v3_interp$year_loess
glimpse(site.comb)
diat.vec <- envfit(comb.mds,env=master_v3_interp[,4:29],na.rm=T)
diat.vec <- data.frame(cbind(diat.vec$vectors$arrows, diat.vec$vectors$r, diat.vec$vectors$pvals))
diat.vec.sig <- subset(diat.vec, diat.vec$V4 <= 0.05 & diat.vec$V3 >= 0.5) #only saves vectors that are significant (p<0.05) and are >50% correlated with ordination
#pigment vectors
pig.vec <- envfit(comb.mds,env=master_v3_interp[,30:41],na.rm=T)
pig.vec <- data.frame(cbind(pig.vec$vectors$arrows, pig.vec$vectors$r, pig.vec$vectors$pvals))
pig.vec.sig <- subset(pig.vec, pig.vec$V4 <= 0.05 & pig.vec$V3 >= 0.5)
diat.vec.sig$var <- "diatom"
pig.vec.sig$var <- "pigment"
comb.vec.sig <- rbind(diat.vec.sig,pig.vec.sig)
print(comb.vec.sig)
comb.vec.sig.scaled <- comb.vec.sig %>%
mutate(X1 = (Dim1*V3)/1.5,
X2 = (Dim2*V3)/1.5)
# Prepare the envfit output for diatoms and pigments
diat.vec <- envfit(comb.mds, env = master_v3_interp[,4:29], na.rm = TRUE)
pig.vec  <- envfit(comb.mds, env = master_v3_interp[,30:41], na.rm = TRUE)
# Combine vectors into a single data frame
diat.df <- data.frame(
Dim1 = diat.vec$vectors$arrows[,1],
Dim2 = diat.vec$vectors$arrows[,2],
r    = diat.vec$vectors$r,
pval = diat.vec$vectors$pvals,
variable = rownames(diat.vec$vectors$arrows),
var_type = "diatom"
)
pig.df <- data.frame(
Dim1 = pig.vec$vectors$arrows[,1],
Dim2 = pig.vec$vectors$arrows[,2],
r    = pig.vec$vectors$r,
pval = pig.vec$vectors$pvals,
variable = rownames(pig.vec$vectors$arrows),
var_type = "pigment"
)
vec.df <- rbind(diat.df, pig.df)
# Top loadings for PC1 and PC2 using absolute correlation (r) with the axis
top_loadings <- rbind(
vec.df %>% arrange(desc(abs(Dim1))) %>% slice(1) %>%
mutate(axis = "PC1", total_variance = var1),
vec.df %>% arrange(desc(abs(Dim2))) %>% slice(1) %>%
mutate(axis = "PC2", total_variance = var2)
)
top_loadings
diat.vec <- envfit(comb.mds, env = master_v3_interp[,4:29], na.rm = TRUE)
pig.vec  <- envfit(comb.mds, env = master_v3_interp[,30:41], na.rm = TRUE)
#plot PCoA paths for all lakes
ggplot(aes(X1, X2),data=site.comb) +
#lake trajectories
geom_path(aes(color=lake), size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.1,"inches")),
lineend="round") +
#vectors
geom_segment(data=comb.vec.sig.scaled,
aes(x=0,y=0,xend=X1,yend=X2),
color="gray") +
geom_point(data=comb.vec.sig.scaled,
aes(x=X1,y=X2,shape=var),color="gray",size=2)+
geom_text(data=comb.vec.sig.scaled,
aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
position=position_jitter(width=0,height=0))+
#general aesthetics
labs(x = "PCoA Axis 1", y = "PCoA Axis 2", color = "Lake") +
scale_x_continuous(limits=c(-0.75,0.75))+
scale_y_continuous(limits=c(-0.75,0.75))+
scale_color_manual(values=c("#d77932", #burnt
"#8b5a2b", #dunnigan
"#9a77b5", #elbow
"#6d91c1", #etwin
"#62497a", #finger
"#9b3d3d", #flame
"#e3b448", #smoke
"#3b5b7c" #wtwin
)) +
labs(
x = paste0("PCoA Axis 1 (", var1, "%)"),
y = paste0("PCoA Axis 2 (", var2, "%)"),
color = "Lake"
)+
theme_classic(base_size=14)
site.comb
comb.vec.sig.scaled
#plot PCoA paths for all lakes
ggplot() +
#lake trajectories
geom_path(data=site.comb,aes(x=Dim1,y=Dim2,color=lake), size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.1,"inches")),
lineend="round") +
#vectors
geom_segment(data=comb.vec.sig.scaled,
aes(x=0,y=0,xend=X1,yend=X2),
color="gray") +
geom_point(data=comb.vec.sig.scaled,
aes(x=X1,y=X2,shape=var),color="gray",size=2)+
geom_text(data=comb.vec.sig.scaled,
aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
position=position_jitter(width=0,height=0))+
#general aesthetics
labs(x = "PCoA Axis 1", y = "PCoA Axis 2", color = "Lake") +
scale_x_continuous(limits=c(-0.75,0.75))+
scale_y_continuous(limits=c(-0.75,0.75))+
scale_color_manual(values=c("#d77932", #burnt
"#8b5a2b", #dunnigan
"#9a77b5", #elbow
"#6d91c1", #etwin
"#62497a", #finger
"#9b3d3d", #flame
"#e3b448", #smoke
"#3b5b7c" #wtwin
)) +
labs(
x = paste0("PCoA Axis 1 (", var1, "%)"),
y = paste0("PCoA Axis 2 (", var2, "%)"),
color = "Lake"
)+
theme_classic(base_size=14)
#plot PCoA paths for all lakes
ggplot() +
#lake trajectories
geom_path(data=site.comb,aes(x=Dim1,y=Dim2,color=lake), size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.1,"inches")),
lineend="round") +
#vectors
geom_segment(data=comb.vec.sig.scaled,
aes(x=0,y=0,xend=X1,yend=X2),
color="gray") +
geom_point(data=comb.vec.sig.scaled,
aes(x=X1,y=X2,shape=var),color="gray",size=2)+
geom_text(data=comb.vec.sig.scaled,
aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
position=position_jitter(width=0,height=0))+
#general aesthetics
labs(x = "PCoA Axis 1", y = "PCoA Axis 2", color = "Lake") +
#scale_x_continuous(limits=c(-0.75,0.75))+
#scale_y_continuous(limits=c(-0.75,0.75))+
scale_color_manual(values=c("#d77932", #burnt
"#8b5a2b", #dunnigan
"#9a77b5", #elbow
"#6d91c1", #etwin
"#62497a", #finger
"#9b3d3d", #flame
"#e3b448", #smoke
"#3b5b7c" #wtwin
)) +
labs(
x = paste0("PCoA Axis 1 (", var1, "%)"),
y = paste0("PCoA Axis 2 (", var2, "%)"),
color = "Lake"
)+
theme_classic(base_size=14)
View(comb.vec.sig.scaled)
#set up variables to run PcoA for each lake in a loop
unique(master_v3_interp$lake)
#put in order for plotting
lakes = c("dunnigan","finger","burnt","smoke","elbow","etwin","flame","wtwin")
#make list of plot titles
lake_plot_titles <- c("Dunnigan","Finger","Burnt","Smoke","Elbow","East Twin","Flame","West Twin")
pcoa.scores_lake <- list() #list to save scores output
pcoa.variable.vectors.lake <- list() #list to save variable vectors
pcoa.plots.lake <- list() #list to save PCoA plots
for (i in 1:length(lakes)) {
#create df for each mixing regime
lake.master.dat <- subset(master_v3_interp,master_v3_interp$lake==lakes[i])
#standardize diatoms and pigments...
diat.stand.hell.lake <- decostand(lake.master.dat[,4:29], method="hellinger")
pig.stand.hell.lake <- decostand(lake.master.dat[,30:41], method="hellinger")
#...to create distance matrices
diat.dist.lake <- dist(diat.stand.hell.lake, method="euclidean")
pig.dist.lake <- dist(pig.stand.hell.lake, method="euclidean")
#combine distance matrices...
comb.dist.lake <- diat.dist.lake+pig.dist.lake
#...and scale
comb.mds.lake <- cmdscale(d=comb.dist.lake, k=2)
#get scores
comb.scores.lake <- data.frame(scores(comb.mds.lake))
#add sample IDs
comb.scores.lake$lake <- lake.master.dat$lake
comb.scores.lake$year <- lake.master.dat$year_loess
#save to list
pcoa.scores_lake[[i]] <- comb.scores.lake
#calculate vectors for diatoms and pigments
#diatom vectors
diat.vec.lake <- envfit(comb.mds.lake,env=lake.master.dat[,4:29],na.rm=T)
diat.vec.lake <- data.frame(cbind(diat.vec.lake$vectors$arrows,
diat.vec.lake$vectors$r,
diat.vec.lake$vectors$pvals),
var_type="diatoms")
#pigments
pig.vec.lake <- envfit(comb.mds.lake,env=lake.master.dat[,30:41],na.rm=T)
pig.vec.lake <- data.frame(cbind(pig.vec.lake$vectors$arrows,
pig.vec.lake$vectors$r,
pig.vec.lake$vectors$pvals),
var_type="pigment")
#keep only significant vectors for plotting
diat.vec.lake.sig <- subset(diat.vec.lake, diat.vec.lake$V4 <= 0.05 & diat.vec.lake$V3 >= 0.5)
pig.vec.lake.sig <- subset(pig.vec.lake, pig.vec.lake$V4 <= 0.05 & pig.vec.lake$V3 >= 0.5)
#save these to list
vec.lake <- rbind(diat.vec.lake.sig,pig.vec.lake.sig) %>% mutate(lake=lakes[i])
pcoa.variable.vectors.lake[[i]] <- vec.lake
# Scale arrows by r2 to show correlation strength
diat.vec.lake.sig.scaled <- diat.vec.lake.sig %>%
mutate(Dim1 = (Dim1*V3)/2,
Dim2 = (Dim2*V3)/2)
pig.vec.lake.sig.scaled <- pig.vec.lake.sig %>%
mutate(Dim1 = (Dim1*V3)/2,
Dim2 = (Dim2*V3)/2)
#create PCoA biplot
#colors
comb.scores.mix <- comb.scores.mix %>%
mutate(color = case_when(
lake == "flame"    ~ "#9b3d3d",
lake == "burnt"    ~ "#d77932",
lake == "smoke"    ~ "#e3b448",
lake == "elbow"    ~ "#9a77b5",
lake == "finger"   ~ "#62497a",
lake == "etwin"    ~ "#6d91c1",
lake == "wtwin"    ~ "#3b5b7c",
lake == "dunnigan" ~ "#8b5a2b"
))
p <-
ggplot(aes(Dim1, Dim2),data=comb.scores.lake) +
#lake trajectories
geom_path(color="black", size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.05,"inches")), lineend="round") +
#pigment vectors
geom_segment(data=pig.vec.lake.sig.scaled,
aes(x=0,y=0,xend=Dim1,yend=Dim2),
color="darkgreen") +
geom_text(data=pig.vec.lake.sig.scaled,
aes(x=Dim1, y=Dim2),label=rownames(pig.vec.lake.sig.scaled),
color="darkgreen", size=3,vjust=-0.5,
position=position_jitter(width=0.1,height=0.1)) +
#diatom vectors
geom_segment(data=diat.vec.lake.sig.scaled,
aes(x=0,y=0,xend=Dim1,yend=Dim2),
color="orange") +
geom_text(data=diat.vec.lake.sig.scaled,
aes(x=Dim1, y=Dim2),label=rownames(diat.vec.lake.sig.scaled),
color="orange", size=3,vjust=-0.5,
position=position_jitter(width=0.1,height=0.1)) +
#general aesthetics
ggtitle(lake_plot_titles[i]) +
theme_classic()+
theme(axis.title=element_blank(),
title=element_text(size=11),
axis.text=element_text(size=10))
pcoa.plots[[i]] <- p
}
for (i in 1:length(lakes)) {
#create df for each mixing regime
lake.master.dat <- subset(master_v3_interp,master_v3_interp$lake==lakes[i])
#standardize diatoms and pigments...
diat.stand.hell.lake <- decostand(lake.master.dat[,4:29], method="hellinger")
pig.stand.hell.lake <- decostand(lake.master.dat[,30:41], method="hellinger")
#...to create distance matrices
diat.dist.lake <- dist(diat.stand.hell.lake, method="euclidean")
pig.dist.lake <- dist(pig.stand.hell.lake, method="euclidean")
#combine distance matrices...
comb.dist.lake <- diat.dist.lake+pig.dist.lake
#...and scale
comb.mds.lake <- cmdscale(d=comb.dist.lake, k=2)
#get scores
comb.scores.lake <- data.frame(scores(comb.mds.lake))
#add sample IDs
comb.scores.lake$lake <- lake.master.dat$lake
comb.scores.lake$year <- lake.master.dat$year_loess
#save to list
pcoa.scores_lake[[i]] <- comb.scores.lake
#calculate vectors for diatoms and pigments
#diatom vectors
diat.vec.lake <- envfit(comb.mds.lake,env=lake.master.dat[,4:29],na.rm=T)
diat.vec.lake <- data.frame(cbind(diat.vec.lake$vectors$arrows,
diat.vec.lake$vectors$r,
diat.vec.lake$vectors$pvals),
var_type="diatoms")
#pigments
pig.vec.lake <- envfit(comb.mds.lake,env=lake.master.dat[,30:41],na.rm=T)
pig.vec.lake <- data.frame(cbind(pig.vec.lake$vectors$arrows,
pig.vec.lake$vectors$r,
pig.vec.lake$vectors$pvals),
var_type="pigment")
#keep only significant vectors for plotting
diat.vec.lake.sig <- subset(diat.vec.lake, diat.vec.lake$V4 <= 0.05 & diat.vec.lake$V3 >= 0.5)
pig.vec.lake.sig <- subset(pig.vec.lake, pig.vec.lake$V4 <= 0.05 & pig.vec.lake$V3 >= 0.5)
#save these to list
vec.lake <- rbind(diat.vec.lake.sig,pig.vec.lake.sig) %>% mutate(lake=lakes[i])
pcoa.variable.vectors.lake[[i]] <- vec.lake
# Scale arrows by r2 to show correlation strength
diat.vec.lake.sig.scaled <- diat.vec.lake.sig %>%
mutate(Dim1 = (Dim1*V3)/2,
Dim2 = (Dim2*V3)/2)
pig.vec.lake.sig.scaled <- pig.vec.lake.sig %>%
mutate(Dim1 = (Dim1*V3)/2,
Dim2 = (Dim2*V3)/2)
#create PCoA biplot
#colors
comb.scores.lake <- comb.scores.lake %>%
mutate(color = case_when(
lake == "flame"    ~ "#9b3d3d",
lake == "burnt"    ~ "#d77932",
lake == "smoke"    ~ "#e3b448",
lake == "elbow"    ~ "#9a77b5",
lake == "finger"   ~ "#62497a",
lake == "etwin"    ~ "#6d91c1",
lake == "wtwin"    ~ "#3b5b7c",
lake == "dunnigan" ~ "#8b5a2b"
))
p <-
ggplot(aes(Dim1, Dim2),data=comb.scores.lake) +
#lake trajectories
geom_path(color="black", size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.05,"inches")), lineend="round") +
#pigment vectors
geom_segment(data=pig.vec.lake.sig.scaled,
aes(x=0,y=0,xend=Dim1,yend=Dim2),
color="darkgreen") +
geom_text(data=pig.vec.lake.sig.scaled,
aes(x=Dim1, y=Dim2),label=rownames(pig.vec.lake.sig.scaled),
color="darkgreen", size=3,vjust=-0.5,
position=position_jitter(width=0.1,height=0.1)) +
#diatom vectors
geom_segment(data=diat.vec.lake.sig.scaled,
aes(x=0,y=0,xend=Dim1,yend=Dim2),
color="orange") +
geom_text(data=diat.vec.lake.sig.scaled,
aes(x=Dim1, y=Dim2),label=rownames(diat.vec.lake.sig.scaled),
color="orange", size=3,vjust=-0.5,
position=position_jitter(width=0.1,height=0.1)) +
#general aesthetics
ggtitle(lake_plot_titles[i]) +
theme_classic()+
theme(axis.title=element_blank(),
title=element_text(size=11),
axis.text=element_text(size=10))
pcoa.plots[[i]] <- p
}
for (i in 1:length(lakes)) {
#create df for each mixing regime
lake.master.dat <- subset(master_v3_interp,master_v3_interp$lake==lakes[i])
#standardize diatoms and pigments...
diat.stand.hell.lake <- decostand(lake.master.dat[,4:29], method="hellinger")
pig.stand.hell.lake <- decostand(lake.master.dat[,30:41], method="hellinger")
#...to create distance matrices
diat.dist.lake <- dist(diat.stand.hell.lake, method="euclidean")
pig.dist.lake <- dist(pig.stand.hell.lake, method="euclidean")
#combine distance matrices...
comb.dist.lake <- diat.dist.lake+pig.dist.lake
#...and scale
comb.mds.lake <- cmdscale(d=comb.dist.lake, k=2)
#get scores
comb.scores.lake <- data.frame(scores(comb.mds.lake))
#add sample IDs
comb.scores.lake$lake <- lake.master.dat$lake
comb.scores.lake$year <- lake.master.dat$year_loess
#save to list
pcoa.scores_lake[[i]] <- comb.scores.lake
#calculate vectors for diatoms and pigments
#diatom vectors
diat.vec.lake <- envfit(comb.mds.lake,env=lake.master.dat[,4:29],na.rm=T)
diat.vec.lake <- data.frame(cbind(diat.vec.lake$vectors$arrows,
diat.vec.lake$vectors$r,
diat.vec.lake$vectors$pvals),
var_type="diatoms")
#pigments
pig.vec.lake <- envfit(comb.mds.lake,env=lake.master.dat[,30:41],na.rm=T)
pig.vec.lake <- data.frame(cbind(pig.vec.lake$vectors$arrows,
pig.vec.lake$vectors$r,
pig.vec.lake$vectors$pvals),
var_type="pigment")
#keep only significant vectors for plotting
diat.vec.lake.sig <- subset(diat.vec.lake, diat.vec.lake$V4 <= 0.05 & diat.vec.lake$V3 >= 0.5)
pig.vec.lake.sig <- subset(pig.vec.lake, pig.vec.lake$V4 <= 0.05 & pig.vec.lake$V3 >= 0.5)
#save these to list
vec.lake <- rbind(diat.vec.lake.sig,pig.vec.lake.sig) %>% mutate(lake=lakes[i])
pcoa.variable.vectors.lake[[i]] <- vec.lake
# Scale arrows by r2 to show correlation strength
diat.vec.lake.sig.scaled <- diat.vec.lake.sig %>%
mutate(Dim1 = (Dim1*V3)/2,
Dim2 = (Dim2*V3)/2)
pig.vec.lake.sig.scaled <- pig.vec.lake.sig %>%
mutate(Dim1 = (Dim1*V3)/2,
Dim2 = (Dim2*V3)/2)
#create PCoA biplot
#colors
comb.scores.lake <- comb.scores.lake %>%
mutate(color = case_when(
lake == "flame"    ~ "#9b3d3d",
lake == "burnt"    ~ "#d77932",
lake == "smoke"    ~ "#e3b448",
lake == "elbow"    ~ "#9a77b5",
lake == "finger"   ~ "#62497a",
lake == "etwin"    ~ "#6d91c1",
lake == "wtwin"    ~ "#3b5b7c",
lake == "dunnigan" ~ "#8b5a2b"
))
p <-
ggplot(aes(Dim1, Dim2),data=comb.scores.lake) +
#lake trajectories
geom_path(color="black", size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.05,"inches")), lineend="round") +
#pigment vectors
geom_segment(data=pig.vec.lake.sig.scaled,
aes(x=0,y=0,xend=Dim1,yend=Dim2),
color="darkgreen") +
geom_text(data=pig.vec.lake.sig.scaled,
aes(x=Dim1, y=Dim2),label=rownames(pig.vec.lake.sig.scaled),
color="darkgreen", size=3,vjust=-0.5,
position=position_jitter(width=0.1,height=0.1)) +
#diatom vectors
geom_segment(data=diat.vec.lake.sig.scaled,
aes(x=0,y=0,xend=Dim1,yend=Dim2),
color="orange") +
geom_text(data=diat.vec.lake.sig.scaled,
aes(x=Dim1, y=Dim2),label=rownames(diat.vec.lake.sig.scaled),
color="orange", size=3,vjust=-0.5,
position=position_jitter(width=0.1,height=0.1)) +
#general aesthetics
ggtitle(lake_plot_titles[i]) +
theme_classic()+
theme(axis.title=element_blank(),
title=element_text(size=11),
axis.text=element_text(size=10))
pcoa.plots.lake[[i]] <- p
}
cowplot::plot_grid(plotlist=pcoa.plots,ncol=2,
labels=c("(a)","(b)","(c)","(d)","(e)","(f)","(g)","(h)"),
label_fontface="plain")
cowplot::plot_grid(plotlist=pcoa.plots.lake,ncol=2,
labels=c("(a)","(b)","(c)","(d)","(e)","(f)","(g)","(h)"),
label_fontface="plain")
pcoa.variable.vectors.lake <- lapply(pcoa.variable.vectors.lake,tibble::rownames_to_column, var="var")
pcoa.sig.variables.lake <- do.call(rbind,lapply(pcoa.variable.vectors.lake,as.data.frame))
## plot up PCoA loadings over time for each lake
pcoa.scores_lake_df <- dplyr::bind_rows(pcoa.scores_lake)
glimpse(pcoa.scores_lake_df)
?round
round(2018.906)
pcoa.scores_lake_df %>%
mutate(year_round = round(year)) %>%
group_by(lake,year_round) %>%
summarize(Dim1 = median(Dim1)) %>%
ggplot(aes(x=year_round,y=Dim1,color=lake))+
geom_vline(xintercept = 1900,lty="dashed")+
geom_vline(xintercept = 1970,lty="dashed")+
#geom_point()+
geom_smooth(se=F)+
#geom_line(size=1)+
theme_classic()
pcoa.scores_lake_df %>%
mutate(year_round = round(year)) %>%
group_by(lake, year_round) %>%
summarize(Dim1 = median(Dim1), .groups = "drop") %>%
ggplot(aes(x = year_round, y = Dim1, color = lake)) +
geom_vline(xintercept = 1900, lty = "dashed") +
geom_vline(xintercept = 1970, lty = "dashed") +
geom_smooth(se = FALSE, size = 1.2) +
theme_classic(base_size = 14) +
scale_color_manual(
values = c(
"burnt"    = "#d77932",
"dunnigan" = "#8b5a2b",
"elbow"    = "#9a77b5",
"etwin"    = "#6d91c1",
"finger"   = "#62497a",
"flame"    = "#9b3d3d",
"smoke"    = "#e3b448",
"wtwin"    = "#3b5b7c"
)
) +
labs(
x = "Year",
y = "PCoA Axis 1 (25.7%)",
color = "Lake"
)
