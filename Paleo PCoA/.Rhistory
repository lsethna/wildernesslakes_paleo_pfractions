#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="gray") +
# geom_point(data=diat.vec.sig.scaled,
#            aes(x=X1,y=X2),color="orange")+
# ggrepel::geom_label_repel(data=diat.vec.sig.scaled,
#           aes(x=X1*1.01, y=X2*1.01),label=rownames(diat.vec.sig.scaled), size=5,
#           color="orange", label.size=NA,fill=NA,
#           force_pull=2) +
#geochem vectors
# geom_segment(data=geochem.vec.sig.scaled,
#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="hotpink",arrow=arrow(length=unit(0.15, "inches"))) +
# ggrepel::geom_label_repel(data=geochem.vec.sig.scaled,http://127.0.0.1:45277/graphics/plot_zoom_png?width=866&height=636
#           aes(x=X1*1.25, y=X2*1.25),label=rownames(geochem.vec.sig.scaled),
#           color="hotpink", label.size=NA,fill=NA) +
#general aesthetics
labs(x = "PCoA Axis 1", y = "PCoA Axis 2", color = "Lake") +
scale_x_continuous(limits=c(-0.75,0.75))+
scale_y_continuous(limits=c(-0.75,0.75))+
scale_color_manual(values=c("#C1D9B7", #burnt
"#89CFF0", #dunnigan
"#007CAA", #elbow
"#665191", #etwin
"#d45087", #finger
"#7A871E", #flame
"#ebdcff", #smoke
"#ffd8c9" #wtwin
)) +
theme_classic(base_size=14)
#plot PCoA paths for all lakes
ggplot(aes(X1, X2),data=site.comb) +
#lake trajectories
geom_path(aes(color=lake), size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.1,"inches")),
lineend="round") +
#vectors
geom_segment(data=comb.vec.sig.scaled,
aes(x=0,y=0,xend=X1,yend=X2),
color="gray") +
geom_point(data=comb.vec.sig.scaled,
aes(x=X1,y=X2,shape=var),color="gray",size=2)+
ggrepel::geom_label_repel(data=comb.vec.sig.scaled,
aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
label.size=NA,fill=NA) +
# #diatom vectors
# geom_segment(data=diat.vec.sig.scaled,
#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="gray") +
# geom_point(data=diat.vec.sig.scaled,
#            aes(x=X1,y=X2),color="orange")+
# ggrepel::geom_label_repel(data=diat.vec.sig.scaled,
#           aes(x=X1*1.01, y=X2*1.01),label=rownames(diat.vec.sig.scaled), size=5,
#           color="orange", label.size=NA,fill=NA,
#           force_pull=2) +
#geochem vectors
# geom_segment(data=geochem.vec.sig.scaled,
#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="hotpink",arrow=arrow(length=unit(0.15, "inches"))) +
# ggrepel::geom_label_repel(data=geochem.vec.sig.scaled,http://127.0.0.1:45277/graphics/plot_zoom_png?width=866&height=636
#           aes(x=X1*1.25, y=X2*1.25),label=rownames(geochem.vec.sig.scaled),
#           color="hotpink", label.size=NA,fill=NA) +
#general aesthetics
labs(x = "PCoA Axis 1", y = "PCoA Axis 2", color = "Lake") +
scale_x_continuous(limits=c(-0.75,0.75))+
scale_y_continuous(limits=c(-0.75,0.75))+
scale_color_manual(values=c("#C1D9B7", #burnt
"#89CFF0", #dunnigan
"#007CAA", #elbow
"#665191", #etwin
"#d45087", #finger
"#7A871E", #flame
"#ebdcff", #smoke
"#ffd8c9" #wtwin
)) +
theme_classic(base_size=14)
#plot PCoA paths for all lakes
ggplot(aes(X1, X2),data=site.comb) +
#lake trajectories
geom_path(aes(color=lake), size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.1,"inches")),
lineend="round") +
#vectors
geom_segment(data=comb.vec.sig.scaled,
aes(x=0,y=0,xend=X1,yend=X2),
color="gray") +
geom_point(data=comb.vec.sig.scaled,
aes(x=X1,y=X2,shape=var),color="gray",size=2)+
geom_text(data=comb.vec.sig.scaled,
aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
label.size=NA,fill=NA) +
# ggrepel::geom_label_repel(data=comb.vec.sig.scaled,
#           aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
#           label.size=NA,fill=NA) +
# #diatom vectors
# geom_segment(data=diat.vec.sig.scaled,
#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="gray") +
# geom_point(data=diat.vec.sig.scaled,
#            aes(x=X1,y=X2),color="orange")+
# ggrepel::geom_label_repel(data=diat.vec.sig.scaled,
#           aes(x=X1*1.01, y=X2*1.01),label=rownames(diat.vec.sig.scaled), size=5,
#           color="orange", label.size=NA,fill=NA,
#           force_pull=2) +
#geochem vectors
# geom_segment(data=geochem.vec.sig.scaled,
#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="hotpink",arrow=arrow(length=unit(0.15, "inches"))) +
# ggrepel::geom_label_repel(data=geochem.vec.sig.scaled,http://127.0.0.1:45277/graphics/plot_zoom_png?width=866&height=636
#           aes(x=X1*1.25, y=X2*1.25),label=rownames(geochem.vec.sig.scaled),
#           color="hotpink", label.size=NA,fill=NA) +
#general aesthetics
labs(x = "PCoA Axis 1", y = "PCoA Axis 2", color = "Lake") +
scale_x_continuous(limits=c(-0.75,0.75))+
scale_y_continuous(limits=c(-0.75,0.75))+
scale_color_manual(values=c("#C1D9B7", #burnt
"#89CFF0", #dunnigan
"#007CAA", #elbow
"#665191", #etwin
"#d45087", #finger
"#7A871E", #flame
"#ebdcff", #smoke
"#ffd8c9" #wtwin
)) +
theme_classic(base_size=14)
#plot PCoA paths for all lakes
ggplot(aes(X1, X2),data=site.comb) +
#lake trajectories
geom_path(aes(color=lake), size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.1,"inches")),
lineend="round") +
#vectors
geom_segment(data=comb.vec.sig.scaled,
aes(x=0,y=0,xend=X1,yend=X2),
color="gray") +
geom_point(data=comb.vec.sig.scaled,
aes(x=X1,y=X2,shape=var),color="gray",size=2)+
# geom_text(data=comb.vec.sig.scaled,
#           aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
#           label.size=NA,fill=NA) +
ggrepel::geom_label_repel(data=comb.vec.sig.scaled,
aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
label.size=NA,fill=NA) +
# #diatom vectors
# geom_segment(data=diat.vec.sig.scaled,
#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="gray") +
# geom_point(data=diat.vec.sig.scaled,
#            aes(x=X1,y=X2),color="orange")+
# ggrepel::geom_label_repel(data=diat.vec.sig.scaled,
#           aes(x=X1*1.01, y=X2*1.01),label=rownames(diat.vec.sig.scaled), size=5,
#           color="orange", label.size=NA,fill=NA,
#           force_pull=2) +
#geochem vectors
# geom_segment(data=geochem.vec.sig.scaled,
#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="hotpink",arrow=arrow(length=unit(0.15, "inches"))) +
# ggrepel::geom_label_repel(data=geochem.vec.sig.scaled,http://127.0.0.1:45277/graphics/plot_zoom_png?width=866&height=636
#           aes(x=X1*1.25, y=X2*1.25),label=rownames(geochem.vec.sig.scaled),
#           color="hotpink", label.size=NA,fill=NA) +
#general aesthetics
labs(x = "PCoA Axis 1", y = "PCoA Axis 2", color = "Lake") +
scale_x_continuous(limits=c(-0.75,0.75))+
scale_y_continuous(limits=c(-0.75,0.75))+
scale_color_manual(values=c("#C1D9B7", #burnt
"#89CFF0", #dunnigan
"#007CAA", #elbow
"#665191", #etwin
"#d45087", #finger
"#7A871E", #flame
"#ebdcff", #smoke
"#ffd8c9" #wtwin
)) +
theme_classic(base_size=14)
#plot PCoA paths for all lakes
ggplot(aes(X1, X2),data=site.comb) +
#lake trajectories
geom_path(aes(color=lake), size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.1,"inches")),
lineend="round") +
#vectors
geom_segment(data=comb.vec.sig.scaled,
aes(x=0,y=0,xend=X1,yend=X2),
color="gray") +
geom_point(data=comb.vec.sig.scaled,
aes(x=X1,y=X2,shape=var),color="gray",size=2)+
geom_text(data=comb.vec.sig.scaled,
aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
position=position_jitter())+
# ggrepel::geom_label_repel(data=comb.vec.sig.scaled,
#           aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
#           label.size=NA,fill=NA) +
#general aesthetics
labs(x = "PCoA Axis 1", y = "PCoA Axis 2", color = "Lake") +
scale_x_continuous(limits=c(-0.75,0.75))+
scale_y_continuous(limits=c(-0.75,0.75))+
scale_color_manual(values=c("#C1D9B7", #burnt
"#89CFF0", #dunnigan
"#007CAA", #elbow
"#665191", #etwin
"#d45087", #finger
"#7A871E", #flame
"#ebdcff", #smoke
"#ffd8c9" #wtwin
)) +
theme_classic(base_size=14)
#plot PCoA paths for all lakes
ggplot(aes(X1, X2),data=site.comb) +
#lake trajectories
geom_path(aes(color=lake), size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.1,"inches")),
lineend="round") +
#vectors
geom_segment(data=comb.vec.sig.scaled,
aes(x=0,y=0,xend=X1,yend=X2),
color="gray") +
geom_point(data=comb.vec.sig.scaled,
aes(x=X1,y=X2,shape=var),color="gray",size=2)+
geom_text(data=comb.vec.sig.scaled,
aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
position=position_jitter(width=0.1,height=0.1))+
# ggrepel::geom_label_repel(data=comb.vec.sig.scaled,
#           aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
#           label.size=NA,fill=NA) +
#general aesthetics
labs(x = "PCoA Axis 1", y = "PCoA Axis 2", color = "Lake") +
scale_x_continuous(limits=c(-0.75,0.75))+
scale_y_continuous(limits=c(-0.75,0.75))+
scale_color_manual(values=c("#C1D9B7", #burnt
"#89CFF0", #dunnigan
"#007CAA", #elbow
"#665191", #etwin
"#d45087", #finger
"#7A871E", #flame
"#ebdcff", #smoke
"#ffd8c9" #wtwin
)) +
theme_classic(base_size=14)
#plot PCoA paths for all lakes
ggplot(aes(X1, X2),data=site.comb) +
#lake trajectories
geom_path(aes(color=lake), size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.1,"inches")),
lineend="round") +
#vectors
geom_segment(data=comb.vec.sig.scaled,
aes(x=0,y=0,xend=X1,yend=X2),
color="gray") +
geom_point(data=comb.vec.sig.scaled,
aes(x=X1,y=X2,shape=var),color="gray",size=2)+
geom_text(data=comb.vec.sig.scaled,
aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
position=position_jitter())+
# ggrepel::geom_label_repel(data=comb.vec.sig.scaled,
#           aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
#           label.size=NA,fill=NA) +
#general aesthetics
labs(x = "PCoA Axis 1", y = "PCoA Axis 2", color = "Lake") +
scale_x_continuous(limits=c(-0.75,0.75))+
scale_y_continuous(limits=c(-0.75,0.75))+
scale_color_manual(values=c("#C1D9B7", #burnt
"#89CFF0", #dunnigan
"#007CAA", #elbow
"#665191", #etwin
"#d45087", #finger
"#7A871E", #flame
"#ebdcff", #smoke
"#ffd8c9" #wtwin
)) +
theme_classic(base_size=14)
?position_jitter
#plot PCoA paths for all lakes
ggplot(aes(X1, X2),data=site.comb) +
#lake trajectories
geom_path(aes(color=lake), size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.1,"inches")),
lineend="round") +
#vectors
geom_segment(data=comb.vec.sig.scaled,
aes(x=0,y=0,xend=X1,yend=X2),
color="gray") +
geom_point(data=comb.vec.sig.scaled,
aes(x=X1,y=X2,shape=var),color="gray",size=2)+
geom_text(data=comb.vec.sig.scaled,
aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
position=position_jitter((width=0.1,height=0.1)))+
#plot PCoA paths for all lakes
ggplot(aes(X1, X2),data=site.comb) +
#lake trajectories
geom_path(aes(color=lake), size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.1,"inches")),
lineend="round") +
#vectors
geom_segment(data=comb.vec.sig.scaled,
aes(x=0,y=0,xend=X1,yend=X2),
color="gray") +
geom_point(data=comb.vec.sig.scaled,
aes(x=X1,y=X2,shape=var),color="gray",size=2)+
geom_text(data=comb.vec.sig.scaled,
aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
position=position_jitter(width=0.1,height=0.1))+
# ggrepel::geom_label_repel(data=comb.vec.sig.scaled,
#           aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
#           label.size=NA,fill=NA) +
#general aesthetics
labs(x = "PCoA Axis 1", y = "PCoA Axis 2", color = "Lake") +
scale_x_continuous(limits=c(-0.75,0.75))+
scale_y_continuous(limits=c(-0.75,0.75))+
scale_color_manual(values=c("#C1D9B7", #burnt
"#89CFF0", #dunnigan
"#007CAA", #elbow
"#665191", #etwin
"#d45087", #finger
"#7A871E", #flame
"#ebdcff", #smoke
"#ffd8c9" #wtwin
)) +
theme_classic(base_size=14)
librarian::shelf(tidyverse,grid,vegan,cowplot,zoo)
glimpse(master_v2)
## ------------------------------- ##
## ---- interpolate variables ---- ##
## ------------------------------- ##
master_v3_interp <- master_v2 %>%
#select variables to interpolate
select(lake,ast_formosa:b_car) %>% glimpse()
glimpse(master_v2)
View(master_v2)
?zoo::na.approx
#plot PCoA paths for all lakes
ggplot(aes(X1, X2),data=site.comb) +
#lake trajectories
geom_path(aes(color=lake), size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.1,"inches")),
lineend="round") +
#vectors
geom_segment(data=comb.vec.sig.scaled,
aes(x=0,y=0,xend=X1,yend=X2),
color="gray") +
geom_point(data=comb.vec.sig.scaled,
aes(x=X1,y=X2,shape=var),color="gray",size=2)+
geom_text(data=comb.vec.sig.scaled,
aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=4,
position=position_jitter(width=0.1,height=0.1))+
#general aesthetics
labs(x = "PCoA Axis 1", y = "PCoA Axis 2", color = "Lake") +
scale_x_continuous(limits=c(-0.75,0.75))+
scale_y_continuous(limits=c(-0.75,0.75))+
scale_color_manual(values=c("#C1D9B7", #burnt
"#89CFF0", #dunnigan
"#007CAA", #elbow
"#665191", #etwin
"#d45087", #finger
"#7A871E", #flame
"#ebdcff", #smoke
"#ffd8c9" #wtwin
)) +
theme_classic(base_size=14)
View(pcoa.scores_lake)
librarian::shelf(tidyverse,grid,vegan,cowplot,zoo)
setwd("C:/Users/lsethna_smm/Documents/GitHub/wildernesslakes_paleo_pfractions/Paleo PCoA")
## plot up PCoA loadings over time for each lake
pcoa.scores_lake_df <- as_tibble(pcoa.scores_lake)
?unlist
## plot up PCoA loadings over time for each lake
pcoa.scores_lake_df <- unlist(pcoa.scores_lake)
## plot up PCoA loadings over time for each lake
pcoa.scores_lake_df <- dplyr::bind_rows(pcoa.scores_lake)
View(pcoa.scores_lake_df)
glimpse(pcoa.scores_lake_df)
ggplot(pcoa.scores_lake_df,aes(x=year,y=Dim1,color=lake))+
geom_point()+
geom_line()+
theme_classic()
ggplot(pcoa.scores_lake_df,aes(x=year,y=Dim1,color=lake))+
geom_point()+
geom_smooth(se=F)+
#geom_line()+
theme_classic()
ggplot(pcoa.scores_lake_df,aes(x=year,y=Dim1,color=lake))+
geom_point()+
geom_smooth(se=F)+
geom_vline(xintercept = 1940,lty="dashed")+
geom_vline(xintercept = 1970,lty="dashed")
ggplot(pcoa.scores_lake_df,aes(x=year,y=Dim1,color=lake))+
geom_vline(xintercept = 1940,lty="dashed")+
geom_vline(xintercept = 1970,lty="dashed")+
geom_point()+
geom_smooth(se=F)+
#geom_line()+
theme_classic()
ggplot(pcoa.scores_lake_df,aes(x=year,y=Dim1,color=lake))+
geom_vline(xintercept = 1940,lty="dashed")+
geom_vline(xintercept = 1970,lty="dashed")+
#geom_point()+
#geom_smooth(se=F)+
geom_line()+
theme_classic()
ggplot(pcoa.scores_lake_df,aes(x=year,y=Dim1,color=lake))+
geom_vline(xintercept = 1940,lty="dashed")+
geom_vline(xintercept = 1970,lty="dashed")+
#geom_point()+
#geom_smooth(se=F)+
geom_line(size=2)+
theme_classic()
ggplot(pcoa.scores_lake_df,aes(x=year,y=Dim1,color=lake))+
geom_vline(xintercept = 1940,lty="dashed")+
geom_vline(xintercept = 1970,lty="dashed")+
#geom_point()+
#geom_smooth(se=F)+
geom_line(size=1)+
theme_classic()
?round
pcoa.scores_lake_df %>%
mutate(year_round = round(year,digits=0))
?is.integer
?is.integer(1902/5)
is.integer(1902/5)
is.integer(1920/5)
1920/5
#round year values to nearest 5, take average?
round_to_nearest_5 <- function(x) {
5 * round(x / 5)
}
round_to_nearest_5(1902)
round_to_nearest_5(1961)
round_to_nearest_5(1961)
round_to_nearest_5(1984)
pcoa.scores_lake_df %>%
mutate(year_round = round_to_nearest_5(year)) %>%
group_by(lake,year_round) %>%
summarize(Dim1 = mean(Dim1)) %>%
ggplot(aes(x=year,y=Dim1,color=lake))+
geom_vline(xintercept = 1940,lty="dashed")+
geom_vline(xintercept = 1970,lty="dashed")+
#geom_point()+
#geom_smooth(se=F)+
geom_line(size=1)+
theme_classic()
pcoa.scores_lake_df %>%
mutate(year_round = round_to_nearest_5(year)) %>%
group_by(lake,year_round) %>%
summarize(Dim1 = mean(Dim1)) %>%
ggplot(aes(x=year_round,y=Dim1,color=lake))+
geom_vline(xintercept = 1940,lty="dashed")+
geom_vline(xintercept = 1970,lty="dashed")+
#geom_point()+
#geom_smooth(se=F)+
geom_line(size=1)+
theme_classic()
#round year values to nearest 5, take average?
round_to_nearest_10 <- function(x) {
10 * round(x / 10)
}
#test
round_to_nearest_10(1984)
#test
round_to_nearest_10(1986)
pcoa.scores_lake_df %>%
mutate(year_round = round_to_nearest_10(year)) %>%
group_by(lake,year_round) %>%
summarize(Dim1 = mean(Dim1)) %>%
ggplot(aes(x=year_round,y=Dim1,color=lake))+
geom_vline(xintercept = 1940,lty="dashed")+
geom_vline(xintercept = 1970,lty="dashed")+
#geom_point()+
#geom_smooth(se=F)+
geom_line(size=1)+
theme_classic()
pcoa.scores_lake_df %>%
mutate(year_round = round_to_nearest_10(year)) %>%
group_by(lake,year_round) %>%
summarize(Dim1 = median(Dim1)) %>%
ggplot(aes(x=year_round,y=Dim1,color=lake))+
geom_vline(xintercept = 1940,lty="dashed")+
geom_vline(xintercept = 1970,lty="dashed")+
#geom_point()+
#geom_smooth(se=F)+
geom_line(size=1)+
theme_classic()
pcoa.scores_lake_df %>%
mutate(year_round = round_to_nearest_10(year)) %>%
group_by(lake,year_round) %>%
summarize(Dim1 = median(Dim1)) %>%
ggplot(aes(x=year_round,y=Dim1,color=lake))+
geom_vline(xintercept = 1940,lty="dashed")+
geom_vline(xintercept = 1970,lty="dashed")+
#geom_point()+
geom_smooth(se=F)+
#geom_line(size=1)+
theme_classic()
pcoa.scores_lake_df %>%
mutate(year_round = round_to_nearest_10(year)) %>%
group_by(lake,year_round) %>%
summarize(Dim1 = median(Dim1)) %>%
ggplot(aes(x=year_round,y=Dim1,color=lake))+
geom_vline(xintercept = 1940,lty="dashed")+
geom_vline(xintercept = 1970,lty="dashed")+
geom_point()+
geom_smooth(se=F)+
#geom_line(size=1)+
theme_classic()
pcoa.scores_lake_df %>%
mutate(year_round = round_to_nearest_10(year)) %>%
group_by(lake,year_round) %>%
summarize(Dim1 = median(Dim1)) %>%
ggplot(aes(x=year_round,y=Dim1,color=lake))+
geom_vline(xintercept = 1940,lty="dashed")+
geom_vline(xintercept = 1970,lty="dashed")+
#geom_point()+
geom_smooth(se=F)+
#geom_line(size=1)+
theme_classic()
