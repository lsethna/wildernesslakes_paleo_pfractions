frag_75 <- c(2,3,5,8,7)
setwd("G:/Shared drives/SCWRS/Sethna/Anoximixis/Conceptual diagrams/Osgood index")
librarian::shelf(tidyverse)
lake_dat <- read.csv("anoximictic_lake_chars.csv")
ggplot(lake_dat,aes(x=(SA_m2^0.25),y=max_depth_m))+
geom_point(aes(fill=obs_anoximixis),pch=21,color="black",size=3)+
#geom_text(aes(label=lake))+
scale_fill_manual(values=c("white","black"),name="Obs. anoximixis")+
scale_x_continuous(limits=c(20,40),name="Surface Area (m2)")+
scale_y_continuous(limits=c(3,12),breaks=seq(3,12,3),name="Max. depth (m)")+
#geom_abline(slope=(1/3),intercept=0,lty="dashed")+
geom_abline(slope=0.25,intercept=0)+
#geom_abline(slope=(1/5),intercept=0,lty="dashed")+
#geom_abline(slope=0.01,intercept=4.2,lty="dashed")+ #for well mixed lakes?
theme_bw(base_size=14)
ggplot(lake_dat,aes(x=(SA_m2^0.25),y=max_depth_m))+
geom_point(aes(fill=obs_anoximixis),pch=21,color="black",size=3)+
#geom_text(aes(label=lake))+
scale_fill_manual(values=c("white","black"),name="Obs. anoximixis")+
scale_x_continuous(#limits=c(20,40),
name="Surface Area (m2)")+
scale_y_continuous(#limits=c(3,12),breaks=seq(3,12,3),
name="Max. depth (m)")+
#geom_abline(slope=(1/3),intercept=0,lty="dashed")+
geom_abline(slope=0.25,intercept=0)+
#geom_abline(slope=(1/5),intercept=0,lty="dashed")+
#geom_abline(slope=0.01,intercept=4.2,lty="dashed")+ #for well mixed lakes?
theme_bw(base_size=14)
ggplot(lake_dat,aes(x=(SA_m2^0.25),y=max_depth_m))+
geom_point(aes(fill=obs_anoximixis),pch=21,color="black",size=3)+
#geom_text(aes(label=lake))+
scale_fill_manual(values=c("white","black"),name="Obs. anoximixis")+
scale_x_continuous(limits=c(20,120),
name="Surface Area (m2)")+
scale_y_continuous(limits=c(5,20),breaks=seq(5,20,5),
name="Max. depth (m)")+
#geom_abline(slope=(1/3),intercept=0,lty="dashed")+
geom_abline(slope=0.25,intercept=0)+
#geom_abline(slope=(1/5),intercept=0,lty="dashed")+
#geom_abline(slope=0.01,intercept=4.2,lty="dashed")+ #for well mixed lakes?
theme_bw(base_size=14)
librarian::shelf(tidyverse)
ggplot(lake_dat,aes(x=(SA_m2^0.25),y=max_depth_m))+
geom_point(aes(fill=obs_anoximixis),pch=21,color="black",size=3)+
#geom_text(aes(label=lake))+
scale_fill_manual(values=c("white","black"),name="Obs. anoximixis")+
scale_x_continuous(limits=c(20,120),
name="Surface Area (m2)")+
scale_y_continuous(limits=c(5,20),breaks=seq(5,20,5),
name="Max. depth (m)")+
#geom_abline(slope=(1/3),intercept=0,lty="dashed")+
geom_abline(slope=0.25,intercept=0)+
#geom_abline(slope=(1/5),intercept=0,lty="dashed")+
#geom_abline(slope=0.01,intercept=4.2,lty="dashed")+ #for well mixed lakes?
theme_bw(base_size=14)
ggplot(lake_dat,aes(x=(SA_m2^0.25),y=max_depth_m))+
geom_point(aes(fill=obs_anoximixis),pch=21,color="black",size=3)+
#geom_text(aes(label=lake))+
scale_fill_manual(values=c("white","black"),name="Obs. anoximixis")+
scale_x_continuous(#limits=c(20,120),
name="Surface Area (m2)")+
scale_y_continuous(#limits=c(5,20),breaks=seq(5,20,5),
name="Max. depth (m)")+
#geom_abline(slope=(1/3),intercept=0,lty="dashed")+
geom_abline(slope=0.25,intercept=0)+
#geom_abline(slope=(1/5),intercept=0,lty="dashed")+
#geom_abline(slope=0.01,intercept=4.2,lty="dashed")+ #for well mixed lakes?
theme_bw(base_size=14)
lake_dat <- read.csv("anoximictic_lake_chars.csv")
ggplot(lake_dat,aes(x=(SA_m2^0.25),y=max_depth_m))+
geom_point(aes(fill=obs_anoximixis),pch=21,color="black",size=3)+
#geom_text(aes(label=lake))+
scale_fill_manual(values=c("white","black"),name="Obs. anoximixis")+
scale_x_continuous(#limits=c(20,120),
name="Surface Area (m2)")+
scale_y_continuous(#limits=c(5,20),breaks=seq(5,20,5),
name="Max. depth (m)")+
#geom_abline(slope=(1/3),intercept=0,lty="dashed")+
geom_abline(slope=0.25,intercept=0)+
#geom_abline(slope=(1/5),intercept=0,lty="dashed")+
#geom_abline(slope=0.01,intercept=4.2,lty="dashed")+ #for well mixed lakes?
theme_bw(base_size=14)
ggplot(lake_dat,aes(x=(SA_m2^0.25),y=max_depth_m))+
geom_point(aes(fill=obs_anoximixis),pch=21,color="black",size=3)+
#geom_text(aes(label=lake))+
scale_fill_manual(values=c("white","black"),name="Obs. anoximixis")+
scale_x_continuous(limits=c(20,120),
name="Surface Area (m2)")+
scale_y_continuous(limits=c(5,20),breaks=seq(5,20,5),
name="Max. depth (m)")+
#geom_abline(slope=(1/3),intercept=0,lty="dashed")+
geom_abline(slope=0.25,intercept=0)+
#geom_abline(slope=(1/5),intercept=0,lty="dashed")+
#geom_abline(slope=0.01,intercept=4.2,lty="dashed")+ #for well mixed lakes?
theme_bw(base_size=14)
rm(list=ls())
getwd()
setwd("C:/Users/lsethna_smm/Documents/GitHub/wildernesslakes_paleo_pfractions/P fractions and TP burial")
master_dat <- read.csv("WL_paleo_masterdataset_20Nov2024.csv")
librarian::shelf(tidyverse)
glimpse(master_dat)
pfrac <- master_dat %>% select(lake,year_loess,dmar_loess,depth,ex_p:recalcitrant_o_p)
glimpse(pfrac)
pfrac$labile <- pfrac$ex_p+pfrac$na_oh_p
#calculate labile and refractory based on Edlund 2017
pfrac$labile <- pfrac$ex_p+pfrac$na_oh_p
pfrac$refractory <- pfrac$mineral_p #mineral_p is HCl_P?
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory))
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(pfrac,aes(x=year_loess,y=value,fill=name))+
geom_bar()
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_bar()
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_bar(stat="identity")
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area()
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area()+
facet_wrap(~lake)
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area()+
facet_wrap(~lake,scales="free_y")
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area()+
theme_bw()+
facet_wrap(~lake,scales="free_y")
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area()+
theme_classic()+
facet_wrap(~lake,scales="free_y")
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area()+
theme_bw()+
facet_wrap(~lake,scales="free_y")
?theme_bw
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area()+
theme_linedraw()+
facet_wrap(~lake,scales="free_y")
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area()+
theme_minimal()+
facet_wrap(~lake,scales="free_y")
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area()+
theme_bw()+
facet_wrap(~lake,scales="free_y")
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area(alpha=0.6 , size=1, color="black")+
theme_bw()+
facet_wrap(~lake,scales="free_y")
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area(alpha=0.6 , size=0.5, color="black")+
theme_bw()+
facet_wrap(~lake,scales="free_y")
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area(alpha=0.6,size=0.5, color="black")+
scale_fill_manual(values=c("yellow","darkgreen"))+
theme_bw()+
facet_wrap(~lake,scales="free_y")
pfrac$refractory <- pfrac$mineral_p+pfrac$labile_o_p #mineral_p is HCl_P, labile_o_p is organic P?
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area(alpha=0.6,size=0.5, color="black")+
scale_fill_manual(values=c("yellow","darkgreen"))+
theme_bw()+
facet_wrap(~lake,scales="free_y")
#clear environment - remove any data/objects that are lurking in your R environment
rm(list=ls())
#set working directory where data are saved
#this one is specific to me, change to be the file location on your computer!
setwd("G:/Shared drives/SCWRS/Sethna/Monson - didymo senior thesis")
librarian::shelf(tidyverse) #the tidyverse contains my favorite packages/functions for organizing and visualizing data
didymo_data <- read.csv("Didymo Fractions Fixed Titles - Master Data.csv")
#need "> 3mm" categories to match exactly! There's an extra space making R think they are different
didymo_data$Diptera_size <- ifelse(didymo_data$Diptera_size=="> 3mm ", #ifelse checks the first statement to be true or false
"> 3mm", #when true, change all instances to this version, without the space
didymo_data$Diptera_size) #when false, leave it be
View(didymo_data)
rm(list=ls())
setwd("C:/Users/lsethna_smm/Documents/GitHub/wildernesslakes_paleo_pfractions/P fractions and TP burial")
librarian::shelf(tidyverse)
master_dat <- read.csv("WL_paleo_masterdataset_20Nov2024.csv")
glimpse(master_dat)
pfrac <- master_dat %>% select(lake,year_loess,dmar_loess,depth,ex_p:recalcitrant_o_p)
#calculate labile and refractory based on Edlund 2017
pfrac$labile <- pfrac$ex_p+pfrac$na_oh_p
pfrac$refractory <- pfrac$mineral_p+pfrac$labile_o_p #mineral_p is HCl_P, labile_o_p is organic P?
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area(alpha=0.6,size=0.5, color="black")+
scale_fill_manual(values=c("yellow","darkgreen"))+
theme_bw()+
facet_wrap(~lake,scales="free_y")
pfrac$refractory <- pfrac$mineral_p+pfrac$recalcitrant_o_p #mineral_p is HCl_P, labile_o_p is organic P?
pfrac %>% select(lake,year_loess,labile,refractory) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area(alpha=0.6,size=0.5, color="black")+
scale_fill_manual(values=c("yellow","darkgreen"))+
theme_bw()+
facet_wrap(~lake,scales="free_y")
glimpse(master_dat)
glimpse(pfrac)
pfrac %>% select(lake,year_loess,labile,refractory,bd_p) %>% pivot_longer(cols=c(labile,refractory)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area(alpha=0.6,size=0.5, color="black")+
scale_fill_manual(values=c("yellow","darkgreen"))+
theme_bw()+
facet_wrap(~lake,scales="free_y")
pfrac %>% select(lake,year_loess,labile,refractory,bd_p) %>% pivot_longer(cols=c(labile,refractory,bd_p)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area(alpha=0.6,size=0.5, color="black")+
scale_fill_manual(values=c("yellow","darkgreen"))+
theme_bw()+
facet_wrap(~lake,scales="free_y")
pfrac %>% select(lake,year_loess,labile,refractory,bd_p) %>% pivot_longer(cols=c(labile,refractory,bd_p)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area(alpha=0.6,size=0.5, color="black")+
scale_fill_manual(values=c("yellow","darkgreen","hotpink"))+
theme_bw()+
facet_wrap(~lake,scales="free_y")
scale_fill_manual(values=c("hotpink","yellow","darkgreen")+
pfrac %>% select(lake,year_loess,labile,refractory,bd_p) %>% pivot_longer(cols=c(labile,refractory,bd_p)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area(alpha=0.6,size=0.5, color="black")+
scale_fill_manual(values=c("hotpink","yellow","darkgreen"))+
theme_bw()+
facet_wrap(~lake,scales="free_y")
)
pfrac %>% select(lake,year_loess,labile,refractory,bd_p) %>% pivot_longer(cols=c(labile,refractory,bd_p)) %>%
ggplot(aes(x=year_loess,y=value,fill=name))+
geom_area(alpha=0.6,size=0.5, color="black")+
scale_fill_manual(values=c("hotpink","yellow","darkgreen"))+
theme_bw()+
facet_wrap(~lake,scales="free_y")
pfrac %>% select(lake,year_loess,labile,refractory,bd_p) %>% pivot_longer(cols=c(labile,refractory,bd_p)) %>%
ggplot(aes(x=depth,y=value,fill=name))+
geom_area(alpha=0.6,size=0.5, color="black")+
scale_fill_manual(values=c("hotpink","yellow","darkgreen"))+
theme_bw()+
facet_wrap(~lake,scales="free_y")
glimpse(pfrac)
pfrac %>% select(lake,depth,year_loess,labile,refractory,bd_p) %>% pivot_longer(cols=c(labile,refractory,bd_p)) %>%
ggplot(aes(x=depth,y=value,fill=name))+
geom_area(alpha=0.6,size=0.5, color="black")+
scale_fill_manual(values=c("hotpink","yellow","darkgreen"))+
theme_bw()+
facet_wrap(~lake,scales="free_y")
pfrac %>% select(lake,depth,year_loess,labile,refractory,bd_p) %>% pivot_longer(cols=c(labile,refractory,bd_p)) %>%
ggplot(aes(x=depth,y=value,fill=name))+
geom_area(alpha=0.6,size=0.5, color="black")+
scale_fill_manual(values=c("hotpink","yellow","darkgreen"))+
theme_bw()+
geom_vline(xintercept=5)+
coord_flip()+
facet_wrap(~lake,scales="free_y")
pfrac %>% select(lake,depth,year_loess,labile,refractory,bd_p) %>% pivot_longer(cols=c(labile,refractory,bd_p)) %>%
ggplot(aes(x=depth,y=value,fill=name))+
geom_area(alpha=0.6,size=0.5, color="black")+
scale_fill_manual(values=c("hotpink","yellow","darkgreen"))+
theme_bw()+
geom_vline(xintercept=5)+
scale_x_reverse()+
coord_flip()+
facet_wrap(~lake,scales="free_y")
pfrac$labile_refrac_ratio <- (pfrac$bd_p+pfrac$labile)/pfrac$refractory
pfrac$bd_TP_ratio <- (pfrac$bd_p)/pfrac$tp_results_mg_p_g
ggplot(pfrac,aes(x=depth,y=bd_TP_ratio))+
geom_line()+
facet_wrap(~lake)
ggplot(pfrac,aes(x=depth,y=bd_TP_ratio))+
geom_point()+
facet_wrap(~lake)+
theme_bw()
View(pfrac)
pfrac %>% filter(depth<5) %>% summarize(bd_TP_ratio = mean(bd_TP_ratio)) %>%
ggplot(aes(x=lake,y=bd_TP_ratio))+
geom_point()+
theme_bw()
pfrac %>% filter(depth<5) %>%
group_by(lake) %>%
summarize(bd_TP_ratio = mean(bd_TP_ratio)) %>%
ggplot(aes(x=lake,y=bd_TP_ratio))+
geom_point()+
theme_bw()
pfrac %>% filter(depth<5) %>%
group_by(lake) %>%
summarize(bd_TP_ratio = mean(bd_TP_ratio,na.rm=T)) %>%
ggplot(aes(x=lake,y=bd_TP_ratio))+
geom_point()+
theme_bw()
pfrac %>% filter(depth<5) %>%
group_by(lake) %>%
summarize(bd_TP_ratio = mean(bd_TP_ratio,na.rm=T)) %>%
ggplot(aes(x=lake,y=bd_TP_ratio))+
geom_point(size=3)+
theme_bw()
glimpse(pfrac)
pfrac$bd_labile_ratio <- pfrac$bd_p/(pfrac$ex_p+pfrac$labile_o_p)
pfrac$lake <- as.factor(pfrac$lake,
levels=c("burnt","smoke","elbow","etwin",
"flame","wtwin",
"dunnigan","finger"))
pfrac %>% filter(depth<5) %>%
group_by(lake) %>%
summarize(bd_labile_ratio = mean(bd_labile_ratio,na.rm=T)) %>%
ggplot(aes(x=lake,y=bd_TP_ratio))+
geom_point(size=3)+
theme_bw()
pfrac %>% filter(depth<5) %>%
group_by(lake) %>%
summarize(bd_labile_ratio = mean(bd_labile_ratio,na.rm=T)) %>%
ggplot(aes(x=lake,y=bd_labile_ratio))+
geom_point(size=3)+
theme_bw()
pfrac$lake <- factor(pfrac$lake,
levels=c("burnt","smoke","elbow","etwin",
"flame","wtwin",
"dunnigan","finger"))
pfrac %>% filter(depth<5) %>%
group_by(lake) %>%
summarize(bd_labile_ratio = mean(bd_labile_ratio,na.rm=T)) %>%
ggplot(aes(x=lake,y=bd_labile_ratio))+
geom_point(size=3)+
theme_bw()
pfrac %>% filter(depth<5) %>%
group_by(lake) %>%
summarize(bd_labile_ratio = mean(bd_labile_ratio,na.rm=T)) %>%
ggplot(aes(x=lake,y=bd_labile_ratio))+
geom_point(size=3)+
theme_bw(base_size=16)
pfrac %>% filter(depth<5) %>%
group_by(lake) %>%
summarize(labile_refrac_ratio = mean(labile_refrac_ratio,na.rm=T)) %>%
ggplot(aes(x=lake,y=labile_refrac_ratio))+
geom_point(size=3)+
theme_bw(base_size=16)
pfrac$labile_refrac_ratio <- (pfrac$bd_p+pfrac$labile_o_p+pfrac$ex_p)/pfrac$refractory
pfrac %>% filter(depth<5) %>%
group_by(lake) %>%
summarize(labile_refrac_ratio = mean(labile_refrac_ratio,na.rm=T)) %>%
ggplot(aes(x=lake,y=labile_refrac_ratio))+
geom_point(size=3)+
theme_bw(base_size=16)
