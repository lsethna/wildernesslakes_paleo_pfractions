label.size=NA,fill=NA) +
# #diatom vectors
# geom_segment(data=diat.vec.sig.scaled,
#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="gray") +
# geom_point(data=diat.vec.sig.scaled,
#            aes(x=X1,y=X2),color="orange")+
# ggrepel::geom_label_repel(data=diat.vec.sig.scaled,
#           aes(x=X1*1.01, y=X2*1.01),label=rownames(diat.vec.sig.scaled), size=5,
#           color="orange", label.size=NA,fill=NA,
#           force_pull=2) +
#geochem vectors
# geom_segment(data=geochem.vec.sig.scaled,
#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="hotpink",arrow=arrow(length=unit(0.15, "inches"))) +
# ggrepel::geom_label_repel(data=geochem.vec.sig.scaled,http://127.0.0.1:45277/graphics/plot_zoom_png?width=866&height=636
#           aes(x=X1*1.25, y=X2*1.25),label=rownames(geochem.vec.sig.scaled),
#           color="hotpink", label.size=NA,fill=NA) +
#general aesthetics
labs(x = "PCoA Axis 1", y = "PCoA Axis 2", color = "Lake") +
scale_x_continuous(limits=c(-0.75,0.75))+
scale_y_continuous(limits=c(-0.75,0.75))+
scale_color_manual(values=c("#C1D9B7", #burnt
"#89CFF0", #dunnigan
"#007CAA", #elbow
"#665191", #etwin
"#d45087", #finger
"#7A871E", #flame
"#ebdcff", #smoke
"#ffd8c9" #wtwin
)) +
theme_classic(base_size=14)
#plot PCoA paths for all lakes
ggplot(aes(X1, X2),data=site.comb) +
#lake trajectories
geom_path(aes(color=lake), size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.1,"inches")),
lineend="round") +
#vectors
geom_segment(data=comb.vec.sig.scaled,
aes(x=0,y=0,xend=X1,yend=X2),
color="gray") +
geom_point(data=comb.vec.sig.scaled,
aes(x=X1,y=X2,fill=var))+
ggrepel::geom_label_repel(data=comb.vec.sig.scaled,
aes(x=X1*1.01, y=X2*1.01),label=rownames(comb.vec.sig.scaled), size=5,
label.size=NA,fill=NA) +
# #diatom vectors
# geom_segment(data=diat.vec.sig.scaled,
#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="gray") +
# geom_point(data=diat.vec.sig.scaled,
#            aes(x=X1,y=X2),color="orange")+
# ggrepel::geom_label_repel(data=diat.vec.sig.scaled,
#           aes(x=X1*1.01, y=X2*1.01),label=rownames(diat.vec.sig.scaled), size=5,
#           color="orange", label.size=NA,fill=NA,
#           force_pull=2) +
#geochem vectors
# geom_segment(data=geochem.vec.sig.scaled,
#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="hotpink",arrow=arrow(length=unit(0.15, "inches"))) +
# ggrepel::geom_label_repel(data=geochem.vec.sig.scaled,http://127.0.0.1:45277/graphics/plot_zoom_png?width=866&height=636
#           aes(x=X1*1.25, y=X2*1.25),label=rownames(geochem.vec.sig.scaled),
#           color="hotpink", label.size=NA,fill=NA) +
#general aesthetics
labs(x = "PCoA Axis 1", y = "PCoA Axis 2", color = "Lake") +
scale_x_continuous(limits=c(-0.75,0.75))+
scale_y_continuous(limits=c(-0.75,0.75))+
scale_color_manual(values=c("#C1D9B7", #burnt
"#89CFF0", #dunnigan
"#007CAA", #elbow
"#665191", #etwin
"#d45087", #finger
"#7A871E", #flame
"#ebdcff", #smoke
"#ffd8c9" #wtwin
)) +
theme_classic(base_size=14)
#plot PCoA paths for all lakes
ggplot(aes(X1, X2),data=site.comb) +
#lake trajectories
geom_path(aes(color=lake), size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.1,"inches")),
lineend="round") +
#vectors
geom_segment(data=comb.vec.sig.scaled,
aes(x=0,y=0,xend=X1,yend=X2),
color="gray") +
geom_point(data=comb.vec.sig.scaled,
aes(x=X1,y=X2,fill=var))+
ggrepel::geom_label_repel(data=comb.vec.sig.scaled,
aes(x=X1*1.01, y=X2*1.01),label=rownames(comb.vec.sig.scaled), size=3,
label.size=NA,fill=NA) +
# #diatom vectors
# geom_segment(data=diat.vec.sig.scaled,
#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="gray") +
# geom_point(data=diat.vec.sig.scaled,
#            aes(x=X1,y=X2),color="orange")+
# ggrepel::geom_label_repel(data=diat.vec.sig.scaled,
#           aes(x=X1*1.01, y=X2*1.01),label=rownames(diat.vec.sig.scaled), size=5,
#           color="orange", label.size=NA,fill=NA,
#           force_pull=2) +
#geochem vectors
# geom_segment(data=geochem.vec.sig.scaled,
#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="hotpink",arrow=arrow(length=unit(0.15, "inches"))) +
# ggrepel::geom_label_repel(data=geochem.vec.sig.scaled,http://127.0.0.1:45277/graphics/plot_zoom_png?width=866&height=636
#           aes(x=X1*1.25, y=X2*1.25),label=rownames(geochem.vec.sig.scaled),
#           color="hotpink", label.size=NA,fill=NA) +
#general aesthetics
labs(x = "PCoA Axis 1", y = "PCoA Axis 2", color = "Lake") +
scale_x_continuous(limits=c(-0.75,0.75))+
scale_y_continuous(limits=c(-0.75,0.75))+
scale_color_manual(values=c("#C1D9B7", #burnt
"#89CFF0", #dunnigan
"#007CAA", #elbow
"#665191", #etwin
"#d45087", #finger
"#7A871E", #flame
"#ebdcff", #smoke
"#ffd8c9" #wtwin
)) +
theme_classic(base_size=14)
View(comb.vec.sig.scaled)
?geom_label
#plot PCoA paths for all lakes
ggplot(aes(X1, X2),data=site.comb) +
#lake trajectories
geom_path(aes(color=lake), size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.1,"inches")),
lineend="round") +
#vectors
geom_segment(data=comb.vec.sig.scaled,
aes(x=0,y=0,xend=X1,yend=X2),
color="gray") +
geom_point(data=comb.vec.sig.scaled,
aes(x=X1,y=X2,fill=var))+
ggrepel::geom_label_repel(data=comb.vec.sig.scaled,
aes(x=X1, y=X2),label=rownames(comb.vec.sig.scaled), size=3) +
# #diatom vectors
# geom_segment(data=diat.vec.sig.scaled,
#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="gray") +
# geom_point(data=diat.vec.sig.scaled,
#            aes(x=X1,y=X2),color="orange")+
# ggrepel::geom_label_repel(data=diat.vec.sig.scaled,
#           aes(x=X1*1.01, y=X2*1.01),label=rownames(diat.vec.sig.scaled), size=5,
#           color="orange", label.size=NA,fill=NA,
#           force_pull=2) +
#geochem vectors
# geom_segment(data=geochem.vec.sig.scaled,
#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="hotpink",arrow=arrow(length=unit(0.15, "inches"))) +
# ggrepel::geom_label_repel(data=geochem.vec.sig.scaled,http://127.0.0.1:45277/graphics/plot_zoom_png?width=866&height=636
#           aes(x=X1*1.25, y=X2*1.25),label=rownames(geochem.vec.sig.scaled),
#           color="hotpink", label.size=NA,fill=NA) +
#general aesthetics
labs(x = "PCoA Axis 1", y = "PCoA Axis 2", color = "Lake") +
scale_x_continuous(limits=c(-0.75,0.75))+
scale_y_continuous(limits=c(-0.75,0.75))+
scale_color_manual(values=c("#C1D9B7", #burnt
"#89CFF0", #dunnigan
"#007CAA", #elbow
"#665191", #etwin
"#d45087", #finger
"#7A871E", #flame
"#ebdcff", #smoke
"#ffd8c9" #wtwin
)) +
theme_classic(base_size=14)
?geom_point
#plot PCoA paths for all lakes
ggplot(aes(X1, X2),data=site.comb) +
#lake trajectories
geom_path(aes(color=lake), size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.1,"inches")),
lineend="round") +
#vectors
geom_segment(data=comb.vec.sig.scaled,
aes(x=0,y=0,xend=X1,yend=X2),
color="gray") +
geom_point(data=comb.vec.sig.scaled,
aes(x=X1,y=X2,fill=var))+
ggrepel::geom_label_repel(data=comb.vec.sig.scaled,
aes(x=X1, y=X2,colour=var),label=rownames(comb.vec.sig.scaled), size=3,
label.size=NA,fill=NA) +
# #diatom vectors
# geom_segment(data=diat.vec.sig.scaled,
#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="gray") +
# geom_point(data=diat.vec.sig.scaled,
#            aes(x=X1,y=X2),color="orange")+
# ggrepel::geom_label_repel(data=diat.vec.sig.scaled,
#           aes(x=X1*1.01, y=X2*1.01),label=rownames(diat.vec.sig.scaled), size=5,
#           color="orange", label.size=NA,fill=NA,
#           force_pull=2) +
#geochem vectors
# geom_segment(data=geochem.vec.sig.scaled,
#              aes(x=0,y=0,xend=X1,yend=X2),
#              color="hotpink",arrow=arrow(length=unit(0.15, "inches"))) +
# ggrepel::geom_label_repel(data=geochem.vec.sig.scaled,http://127.0.0.1:45277/graphics/plot_zoom_png?width=866&height=636
#           aes(x=X1*1.25, y=X2*1.25),label=rownames(geochem.vec.sig.scaled),
#           color="hotpink", label.size=NA,fill=NA) +
#general aesthetics
labs(x = "PCoA Axis 1", y = "PCoA Axis 2", color = "Lake") +
scale_x_continuous(limits=c(-0.75,0.75))+
scale_y_continuous(limits=c(-0.75,0.75))+
scale_color_manual(values=c("#C1D9B7", #burnt
"#89CFF0", #dunnigan
"#007CAA", #elbow
"#665191", #etwin
"#d45087", #finger
"#7A871E", #flame
"#ebdcff", #smoke
"#ffd8c9" #wtwin
)) +
theme_classic(base_size=14)
View(pcoa.scores_lake)
View(pcoa.variable.vectors.lake)
View(vec.lake)
View(vec.lake)
pcoa.variable.vectors.lake[[1]]
for (i in 1:length(lakes)) {
#create df for each mixing regime
lake.master.dat <- subset(master_v3_interp,master_v3_interp$lake==lakes[i])
#standardize diatoms and pigments...
diat.stand.hell.lake <- decostand(lake.master.dat[,8:33], method="hellinger")
pig.stand.hell.lake <- decostand(lake.master.dat[,34:45], method="hellinger")
#...to create distance matrices
diat.dist.lake <- dist(diat.stand.hell.lake, method="euclidean")
pig.dist.lake <- dist(pig.stand.hell.lake, method="euclidean")
#combine distance matrices...
comb.dist.lake <- diat.dist.lake+pig.dist.lake
#...and scale
comb.mds.lake <- cmdscale(d=comb.dist.lake, k=2)
#get scores
comb.scores.lake <- data.frame(scores(comb.mds.lake))
#add sample IDs
comb.scores.lake$lake <- lake.master.dat$lake
comb.scores.lake$year <- lake.master.dat$year_loess
#save to list
pcoa.scores_lake[[i]] <- comb.scores.lake
#calculate vectors for diatoms and pigments
#diatom vectors
diat.vec.lake <- envfit(comb.mds.lake,env=lake.master.dat[,8:33],na.rm=T)
diat.vec.lake <- data.frame(cbind(diat.vec.lake$vectors$arrows,
diat.vec.lake$vectors$r,
diat.vec.lake$vectors$pvals),
var_type="diatoms")
#pigments
pig.vec.lake <- envfit(comb.mds.lake,env=lake.master.dat[,34:45],na.rm=T)
pig.vec.lake <- data.frame(cbind(pig.vec.lake$vectors$arrows,
pig.vec.lake$vectors$r,
pig.vec.lake$vectors$pvals),
var_type="pigment")
#keep only significant vectors for plotting
diat.vec.lake.sig <- subset(diat.vec.lake, diat.vec.lake$V4 <= 0.05 & diat.vec.lake$V3 >= 0.5)
pig.vec.lake.sig <- subset(pig.vec.lake, pig.vec.lake$V4 <= 0.05 & pig.vec.lake$V3 >= 0.5)
#save these to list
vec.lake <- rbind(diat.vec.lake.sig,pig.vec.lake.sig) %>% mutate(lake=lakes[i])
pcoa.variable.vectors.lake[[i]] <- vec.lake
# Scale arrows by r2 to show correlation strength
diat.vec.lake.sig.scaled <- diat.vec.lake.sig %>%
mutate(Dim1 = (Dim1*V3)/2,
Dim2 = (Dim2*V3)/2)
pig.vec.lake.sig.scaled <- pig.vec.lake.sig %>%
mutate(Dim1 = (Dim1*V3)/2,
Dim2 = (Dim2*V3)/2)
#create PCoA biplot
p <-
ggplot(aes(Dim1, Dim2),data=comb.scores.lake) +
#lake trajectories
geom_path(color="black", size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.05,"inches")), lineend="round") +
#pigment vectors
geom_segment(data=pig.vec.lake.sig.scaled,
aes(x=0,y=0,xend=Dim1,yend=Dim2),
color="darkgreen") +
geom_text(data=pig.vec.lake.sig.scaled,
aes(x=Dim1, y=Dim2),label=rownames(pig.vec.lake.sig.scaled),
color="darkgreen", size=4,vjust=-0.5,
position=position_jitter(width=0.1,height=0.1)) +
#diatom vectors
geom_segment(data=diat.vec.lake.sig.scaled,
aes(x=0,y=0,xend=Dim1,yend=Dim2),
color="orange") +
geom_text(data=diat.vec.lake.sig.scaled,
aes(x=Dim1, y=Dim2),label=rownames(diat.vec.lake.sig.scaled),
color="orange", size=4,vjust=-0.5,
position=position_jitter(width=0.1,height=0.1)) +
#general aesthetics
ggtitle(lake_plot_titles[i]) +
theme_classic()+
theme(axis.title=element_blank(),
title=element_text(size=11),
axis.text=element_text(size=10))
pcoa.plots[[i]] <- p
}
cowplot::plot_grid(plotlist=pcoa.plots,ncol=2,
labels=c("(a)","(b)","(c)","(d)","(e)","(f)","(g)","(h)"),
label_fontface="plain")
for (i in 1:length(lakes)) {
#create df for each mixing regime
lake.master.dat <- subset(master_v3_interp,master_v3_interp$lake==lakes[i])
#standardize diatoms and pigments...
diat.stand.hell.lake <- decostand(lake.master.dat[,8:33], method="hellinger")
pig.stand.hell.lake <- decostand(lake.master.dat[,34:45], method="hellinger")
#...to create distance matrices
diat.dist.lake <- dist(diat.stand.hell.lake, method="euclidean")
pig.dist.lake <- dist(pig.stand.hell.lake, method="euclidean")
#combine distance matrices...
comb.dist.lake <- diat.dist.lake+pig.dist.lake
#...and scale
comb.mds.lake <- cmdscale(d=comb.dist.lake, k=2)
#get scores
comb.scores.lake <- data.frame(scores(comb.mds.lake))
#add sample IDs
comb.scores.lake$lake <- lake.master.dat$lake
comb.scores.lake$year <- lake.master.dat$year_loess
#save to list
pcoa.scores_lake[[i]] <- comb.scores.lake
#calculate vectors for diatoms and pigments
#diatom vectors
diat.vec.lake <- envfit(comb.mds.lake,env=lake.master.dat[,8:33],na.rm=T)
diat.vec.lake <- data.frame(cbind(diat.vec.lake$vectors$arrows,
diat.vec.lake$vectors$r,
diat.vec.lake$vectors$pvals),
var_type="diatoms")
#pigments
pig.vec.lake <- envfit(comb.mds.lake,env=lake.master.dat[,34:45],na.rm=T)
pig.vec.lake <- data.frame(cbind(pig.vec.lake$vectors$arrows,
pig.vec.lake$vectors$r,
pig.vec.lake$vectors$pvals),
var_type="pigment")
#keep only significant vectors for plotting
diat.vec.lake.sig <- subset(diat.vec.lake, diat.vec.lake$V4 <= 0.05 & diat.vec.lake$V3 >= 0.5)
pig.vec.lake.sig <- subset(pig.vec.lake, pig.vec.lake$V4 <= 0.05 & pig.vec.lake$V3 >= 0.5)
#save these to list
vec.lake <- rbind(diat.vec.lake.sig,pig.vec.lake.sig) %>% mutate(lake=lakes[i])
pcoa.variable.vectors.lake[[i]] <- vec.lake
# Scale arrows by r2 to show correlation strength
diat.vec.lake.sig.scaled <- diat.vec.lake.sig %>%
mutate(Dim1 = (Dim1*V3)/2,
Dim2 = (Dim2*V3)/2)
pig.vec.lake.sig.scaled <- pig.vec.lake.sig %>%
mutate(Dim1 = (Dim1*V3)/2,
Dim2 = (Dim2*V3)/2)
#create PCoA biplot
p <-
ggplot(aes(Dim1, Dim2),data=comb.scores.lake) +
#lake trajectories
geom_path(color="black", size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.05,"inches")), lineend="round") +
#pigment vectors
geom_segment(data=pig.vec.lake.sig.scaled,
aes(x=0,y=0,xend=Dim1,yend=Dim2),
color="darkgreen") +
geom_text(data=pig.vec.lake.sig.scaled,
aes(x=Dim1, y=Dim2),label=rownames(pig.vec.lake.sig.scaled),
color="darkgreen", size=2,vjust=-0.5,
position=position_jitter(width=0.1,height=0.1)) +
#diatom vectors
geom_segment(data=diat.vec.lake.sig.scaled,
aes(x=0,y=0,xend=Dim1,yend=Dim2),
color="orange") +
geom_text(data=diat.vec.lake.sig.scaled,
aes(x=Dim1, y=Dim2),label=rownames(diat.vec.lake.sig.scaled),
color="orange", size=2,vjust=-0.5,
position=position_jitter(width=0.1,height=0.1)) +
#general aesthetics
ggtitle(lake_plot_titles[i]) +
theme_classic()+
theme(axis.title=element_blank(),
title=element_text(size=11),
axis.text=element_text(size=10))
pcoa.plots[[i]] <- p
}
cowplot::plot_grid(plotlist=pcoa.plots,ncol=2,
labels=c("(a)","(b)","(c)","(d)","(e)","(f)","(g)","(h)"),
label_fontface="plain")
for (i in 1:length(lakes)) {
#create df for each mixing regime
lake.master.dat <- subset(master_v3_interp,master_v3_interp$lake==lakes[i])
#standardize diatoms and pigments...
diat.stand.hell.lake <- decostand(lake.master.dat[,8:33], method="hellinger")
pig.stand.hell.lake <- decostand(lake.master.dat[,34:45], method="hellinger")
#...to create distance matrices
diat.dist.lake <- dist(diat.stand.hell.lake, method="euclidean")
pig.dist.lake <- dist(pig.stand.hell.lake, method="euclidean")
#combine distance matrices...
comb.dist.lake <- diat.dist.lake+pig.dist.lake
#...and scale
comb.mds.lake <- cmdscale(d=comb.dist.lake, k=2)
#get scores
comb.scores.lake <- data.frame(scores(comb.mds.lake))
#add sample IDs
comb.scores.lake$lake <- lake.master.dat$lake
comb.scores.lake$year <- lake.master.dat$year_loess
#save to list
pcoa.scores_lake[[i]] <- comb.scores.lake
#calculate vectors for diatoms and pigments
#diatom vectors
diat.vec.lake <- envfit(comb.mds.lake,env=lake.master.dat[,8:33],na.rm=T)
diat.vec.lake <- data.frame(cbind(diat.vec.lake$vectors$arrows,
diat.vec.lake$vectors$r,
diat.vec.lake$vectors$pvals),
var_type="diatoms")
#pigments
pig.vec.lake <- envfit(comb.mds.lake,env=lake.master.dat[,34:45],na.rm=T)
pig.vec.lake <- data.frame(cbind(pig.vec.lake$vectors$arrows,
pig.vec.lake$vectors$r,
pig.vec.lake$vectors$pvals),
var_type="pigment")
#keep only significant vectors for plotting
diat.vec.lake.sig <- subset(diat.vec.lake, diat.vec.lake$V4 <= 0.05 & diat.vec.lake$V3 >= 0.5)
pig.vec.lake.sig <- subset(pig.vec.lake, pig.vec.lake$V4 <= 0.05 & pig.vec.lake$V3 >= 0.5)
#save these to list
vec.lake <- rbind(diat.vec.lake.sig,pig.vec.lake.sig) %>% mutate(lake=lakes[i])
pcoa.variable.vectors.lake[[i]] <- vec.lake
# Scale arrows by r2 to show correlation strength
diat.vec.lake.sig.scaled <- diat.vec.lake.sig %>%
mutate(Dim1 = (Dim1*V3)/2,
Dim2 = (Dim2*V3)/2)
pig.vec.lake.sig.scaled <- pig.vec.lake.sig %>%
mutate(Dim1 = (Dim1*V3)/2,
Dim2 = (Dim2*V3)/2)
#create PCoA biplot
p <-
ggplot(aes(Dim1, Dim2),data=comb.scores.lake) +
#lake trajectories
geom_path(color="black", size=0.75,
arrow=arrow(type="closed", ends="first",length=unit(0.05,"inches")), lineend="round") +
#pigment vectors
geom_segment(data=pig.vec.lake.sig.scaled,
aes(x=0,y=0,xend=Dim1,yend=Dim2),
color="darkgreen") +
geom_text(data=pig.vec.lake.sig.scaled,
aes(x=Dim1, y=Dim2),label=rownames(pig.vec.lake.sig.scaled),
color="darkgreen", size=3,vjust=-0.5,
position=position_jitter(width=0.1,height=0.1)) +
#diatom vectors
geom_segment(data=diat.vec.lake.sig.scaled,
aes(x=0,y=0,xend=Dim1,yend=Dim2),
color="orange") +
geom_text(data=diat.vec.lake.sig.scaled,
aes(x=Dim1, y=Dim2),label=rownames(diat.vec.lake.sig.scaled),
color="orange", size=3,vjust=-0.5,
position=position_jitter(width=0.1,height=0.1)) +
#general aesthetics
ggtitle(lake_plot_titles[i]) +
theme_classic()+
theme(axis.title=element_blank(),
title=element_text(size=11),
axis.text=element_text(size=10))
pcoa.plots[[i]] <- p
}
cowplot::plot_grid(plotlist=pcoa.plots,ncol=2,
labels=c("(a)","(b)","(c)","(d)","(e)","(f)","(g)","(h)"),
label_fontface="plain")
sel_pig
pcoa.variable.vectors.lake
#move rownames (important variables) to a column
pcoa.variable.vectors.lake <- lapply(pcoa.variable.vectors.lake,tibble::rownames_to_column, var="var")
pcoa.variable.vectors.lake
pcoa.sig.variables.lake <- lapply(pcoa.variable.vectors.lake,as.data.frame)
write_csv(pcoa_sig_variables_lake,file="sig_variables_pcoa_by_lake.csv")
write.csv(pcoa_sig_variables_lake,file="sig_variables_pcoa_by_lake.csv")
write.csv(pcoa.sig.variables.lake,file="sig_variables_pcoa_by_lake.csv")
pcoa.sig.variables.lake
pcoa.sig.variables.lake <- lapply(pcoa.variable.vectors.lake,as.data.frame)
pcoa.sig.variables.lake
pcoa.sig.variables.lake <- rbind(lapply(pcoa.variable.vectors.lake,as.data.frame))
pcoa.sig.variables.lake
pcoa.sig.variables.lake <- do.call(rbind,lapply(pcoa.variable.vectors.lake,as.data.frame))
pcoa.sig.variables.lake
unique(pcoa.sig.variables.lake$lake)
write.csv(pcoa.sig.variables.lake,file="sig_variables_pcoa_by_lake.csv")
#export
write.csv(pretty_name_code,file="pcoa_variable_abbr.csv")
setwd("C:/Users/lsethna_smm/Documents/GitHub/wildernesslakes_paleo_pfractions") #change this to match local GitHub folder
## ----------------------------------- ##
# Housekeeping ----
## ----------------------------------- ##
rm(list=ls())
## ----------------------------------- ##
# Read in data ----
## ----------------------------------- ##
#master data
master_dat <- read.csv("raw_data/WL_paleo_masterdataset_20Nov2024.csv") %>% select(!X)
#Organic C variable; keep only lake, date,and org_C variables
org_c <- read.csv("raw_data/deriv_orgC.csv") %>% select(lake,year_loess,orgC_burial_g_cm2_yr,deriv_orgC)
#install.packages(librarian)
librarian::shelf(tidyverse, readxl,rioja)
setwd("C:/Users/lsethna_smm/Documents/GitHub/wildernesslakes_paleo_pfractions") #change this to match local GitHub folder
## ----------------------------------- ##
# Read in data ----
## ----------------------------------- ##
#master data
master_dat <- read.csv("raw_data/WL_paleo_masterdataset_20Nov2024.csv") %>% select(!X)
#Organic C variable; keep only lake, date,and org_C variables
org_c <- read.csv("raw_data/deriv_orgC.csv") %>% select(lake,year_loess,orgC_burial_g_cm2_yr,deriv_orgC)
#pfrac data
pfrac <- read.csv("raw_data/pfrac.csv") %>% pivot_wider(id_cols=c(lake,bottom_interval_cm)) %>%
rename(depth=bottom_interval_cm)
## merge together
master_dat_v2 <- master_dat %>% left_join(org_c) %>% left_join(pfrac)
## get variables from PCoA
imp_variables <- read.csv("Paleo PCoA/sig_variables_pcoa_by_lake.csv")
variable_code <- read.csv("Paleo PCoA/pcoa_variable_abbr.csv")
?setNames
glimpse(variable_code)
