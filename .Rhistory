## ----------------------------------- ##
# Housekeeping ----
## ----------------------------------- ##
rm(list=ls())
#install.packages(librarian)
librarian::shelf(tidyverse, googledrive,readxl,rioja)
getwd()
#change this to match local GitHub folder
setwd("C:/Users/16512/Documents/GitHub/wildernesslakes_paleo_pfractions") #change this to match local GitHub folder
## ----------------------------------- ##
# Download data ----
## ----------------------------------- ##
# Identify URLs of Drive folders with needed data
master_url <- googledrive::as_id("https://drive.google.com/drive/u/0/folders/13rrJv6QRCx4q342zEjsmbiO1J0xZuyzk")
#change this to match local GitHub folder
setwd("C:/Users/16512/Documents/GitHub/wildernesslakes_paleo_pfractions") #change this to match local GitHub folder
## ----------------------------------- ##
# Housekeeping ----
## ----------------------------------- ##
rm(list=ls())
#change this to match local GitHub folder
setwd("C:/Users/16512/Documents/GitHub/wildernesslakes_paleo_pfractions") #change this to match local GitHub folder
#read in data from folder
library(readr)
WL_paleo_masterdataset_14Oct2024 <- read_csv("WL_paleo_masterdataset_14Oct2024.csv")
WL_paleo<- read_csv("WL_paleo_masterdataset_14Oct2024.csv")
## ----------------------------------- ##
# Read in data ----
## ----------------------------------- ##
master_dat <- read.csv("raw_data/WL_paleo_masterdataset_25Sept2024.csv") %>% select(!X)
#check
glimpse(master_dat)
#interpolated master dat
int_master_dat <- read.csv("raw_data/interpolated_master_dat_15Oct24.csv")
glimpse(int_master_dat)
#check normality of data to determine if you need to transform it:
qqnorm(int_master_dat$percent_organic)
qqnorm(int_master_dat$percent_inorg)
?filter
burnt <- filter(int_master_dat, lake== "burnt")
qqnorm(burnt$percent_organic)
qqnorm(i(burnt$percent_inorg)
qqnorm(burnt$percent_inorg)
qqnorm(burnt$percent_inorg)
glimpse(int_master_dat)
View(int_master_dat)
#WRC presentation
wrc <- master_dat %>% select(c(lake,year_loess,percent_organic, #selecting col
tp_results_mg_p_g,bd_p,
sio2_wt_percent,
chl_a,echine,cantha,
fra_crotonensis,ast_formosa))
View(master_dat)
View(int_master_dat)
#check
glimpse(master_dat)
qqnorm(burnt$percent_organic)
burnt <- filter(master_dat, lake== "burnt")
qqnorm(burnt$percent_organic)
qqnorm(burnt$percent_inorg)
qqnorm(burnt$sio2_wt_percent)
qqnorm(burnt$tp_results_mg_p_g)
qqnorm(burnt$labile_o_p)
qqnorm(burnt$recalcitrant_o_p)
qqnorm(burnt$echine)
qqnorm(burnt$cantha)
qqnorm(burnt$myxo)
qqnorm(burnt$fra_crotonensis)
qqnorm(burnt$ast_formosa)
qqnorm(burnt$percent_organic)
qqnorm(burnt$percent_inorg)
qqnorm(burnt$sio2_wt_percent)
qqnorm(burnt$tp_results_mg_p_g)
qqnorm(burnt$labile_o_p)
qqnorm(burnt$recalcitrant_o_p)
qqnorm(burnt$echine)
qqnorm(burnt$cantha)
qqnorm(burnt$myxo)
qqnorm(burnt$fra_crotonensis)
qqnorm(burnt$ast_formosa)
qqplot(burnt$percent_organic)
qqnorm(burnt$fra_crotonensis) #not normal for Burnt
qqnorm(burnt$myxo)
qqnorm(burnt$echine)
qqnorm(burnt$echine)
qqnorm(burnt$recalcitrant_o_p)
qqnorm(burnt$labile_o_p)
smoke <- filter(master_dat, lake== "smoke")
qqnorm(smoke$percent_organic)
qqnorm(smoke$percent_inorg)
qqnorm(smoke$sio2_wt_percent)
qqnorm(smoke$tp_results_mg_p_g)
qqnorm(smoke$labile_o_p)
qqnorm(smoke$recalcitrant_o_p)
qqnorm(smoke$echine)
qqnorm(smoke$cantha)
qqnorm(smoke$myxo)
qqnorm(smoke$fra_crotonensis)
qqnorm(smoke$ast_formosa)
qqnorm(master_dat$ast_formosa)+
facet_wrap(~lake)
qqnorm(master_dat$ast_formosa)
qqnorm(master_dat$percent_organic) #not normal for master_dat
qqnorm(master_dat$percent_inorg) #not normal for master_dat
qqnorm(master_dat$sio2_wt_percent)
qqnorm(master_dat$tp_results_mg_p_g)
qqnorm(master_dat$labile_o_p)
qqnorm(master_dat$recalcitrant_o_p)
qqnorm(master_dat$echine)
qqnorm(master_dat$cantha)
qqnorm(master_dat$myxo)
qqnorm(master_dat$fra_crotonensis)
qqnorm(master_dat$ast_formosa)
qq_plot(percent_organic ~ lake, data = master_dat)
qqplot(percent_organic ~ lake, data = master_dat)
qqplot(percent_organic ~lake, data = master_dat)
ggplot(master_dat, aes(sample = percent_organic)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake)
ggplot(master_dat, aes(sample = percent_organic)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = percent_inorganic)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = percent_inorg)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = sio2_wt_percent)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = tp_results_mg_p_g)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = labile_o_p)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = recalcitrant_o_p)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = echine)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = cantha)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = myxo)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
cpt.meanvar(master_dat,penalty="MBIC",pen.value=0,method="AMOC",Q=5,test.stat="Normal",
class=TRUE,param.estimates=TRUE,shape=1,minseglen=2)
#Change point analysis
library(changepoint)
cpt.meanvar(master_dat,penalty="MBIC",pen.value=0,method="AMOC",Q=5,test.stat="Normal",
class=TRUE,param.estimates=TRUE,shape=1,minseglen=2)
cpt.meanvar(master_dat$percent_organic,penalty="MBIC",pen.value=0,method="AMOC",Q=5,test.stat="Normal",
class=TRUE,param.estimates=TRUE,shape=1,minseglen=2)
View(int_master_dat)
cpt.meanvar(int_master_dat,penalty="MBIC",pen.value=0,method="AMOC",Q=5,test.stat="Normal",
class=TRUE,param.estimates=TRUE,shape=1,minseglen=2)
cpt.meanvar(int_master_dat$percent_organic,penalty="MBIC",pen.value=0,method="AMOC",Q=5,test.stat="Normal",
class=TRUE,param.estimates=TRUE,shape=1,minseglen=2)
ggplot(master_dat, aes(sample = percent_organic)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = percent_inorg)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = sio2_wt_percent)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = tp_results_mg_p_g)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = labile_o_p)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = recalcitrant_o_p)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = echine)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = cantha)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = myxo)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = percent_organic)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = percent_inorg)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = sio2_wt_percent)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
ggplot(master_dat, aes(sample = tp_results_mg_p_g)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ lake, scales = "free")
