ggplot(aes(y=value,x=year_loess))+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
coord_flip()+
scale_x_continuous(breaks=seq(1860,2020,20))+
facet_wrap(~name,ncol=16,scales="free_x")+
labs(x="Year",title="Dunnigan (well-mixed)")+
plot_theme
#Finger
finger_paleo <- paleo_prod_long %>%
filter(lake=="finger") %>%
ggplot(aes(y=value,x=year_loess))+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
coord_flip()+
scale_x_continuous(breaks=seq(1860,2020,20))+
facet_wrap(~name,ncol=16,scales="free_x")+
labs(x="Year",title="Finger (well-mixed)")+
plot_theme
#Flame
flame_paleo <- paleo_prod_long %>%
filter(lake=="flame") %>%
ggplot(aes(y=value,x=year_loess))+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
coord_flip()+
scale_x_continuous(breaks=seq(1860,2020,20))+
facet_wrap(~name,ncol=16,scales="free_x")+
labs(x="Year",title="Flame (dimictic)")+
plot_theme
#West Twin
wtwin_paleo <- paleo_prod_long %>%
filter(lake=="wtwin") %>%
ggplot(aes(y=value,x=year_loess))+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
coord_flip()+
scale_x_continuous(breaks=seq(1860,2020,20))+
facet_wrap(~name,ncol=16,scales="free_x")+
labs(x="Year",title="West Twin (dimictic)")+
plot_theme
#Burnt
burnt_paleo <- paleo_prod_long %>%
filter(lake=="burnt") %>%
ggplot(aes(y=value,x=year_loess))+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
coord_flip()+
scale_x_continuous(breaks=seq(1860,2020,20))+
facet_wrap(~name,ncol=16,scales="free_x")+
labs(x="Year",title="Burnt (polymictic)")+
plot_theme
#Smoke
smoke_paleo <- paleo_prod_long %>%
filter(lake=="smoke") %>%
ggplot(aes(y=value,x=year_loess))+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
coord_flip()+
scale_x_continuous(breaks=seq(1860,2020,20))+
facet_wrap(~name,ncol=16,scales="free_x")+
labs(x="Year",title="Smoke (polymictic)")+
plot_theme
#Elbow
elbow_paleo <- paleo_prod_long %>%
filter(lake=="elbow") %>%
ggplot(aes(y=value,x=year_loess))+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
coord_flip()+
scale_x_continuous(breaks=seq(1860,2020,20))+
facet_wrap(~name,ncol=16,scales="free_x")+
labs(x="Year",title="Elbow (polymictic)")+
plot_theme
#East Twin
etwin_paleo <- paleo_prod_long %>%
filter(lake=="etwin") %>%
ggplot(aes(y=value,x=year_loess))+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
coord_flip()+
scale_x_continuous(breaks=seq(1860,2020,20))+
facet_wrap(~name,ncol=16,scales="free_x")+
labs(x="Year",title="East Twin (polymictic)")+
plot_theme
cowplot::plot_grid(dunnigan_paleo,finger_paleo,
flame_paleo,wtwin_paleo,
burnt_paleo,smoke_paleo,
elbow_paleo,etwin_paleo,
nrow=4,labels="AUTO")
flame_paleo
wtwin_paleo
## ----------------------------------- ##
# Housekeeping ----
## ----------------------------------- ##
rm(list=ls())
#install.packages(librarian)
librarian::shelf(tidyverse, googledrive,readxl,rioja)
## ----------------------------------- ##
# Read in data ----
## ----------------------------------- ##
master_dat <- read.csv("raw_data/WL_paleo_masterdataset_20Nov2024.csv") #%>% select(!X)
getwd()
setwd("C:/Users/lsethna_smm/Documents/GitHub/wildernesslakes_paleo_pfractions") #change this to match local GitHub folder
## ----------------------------------- ##
# Read in data ----
## ----------------------------------- ##
master_dat <- read.csv("raw_data/WL_paleo_masterdataset_20Nov2024.csv") #%>% select(!X)
#interpolated master dat
int_master_dat <- read.csv("raw_data/interpolated_master_dat_10Dec24.csv")
#interpolated master dat
int_master_dat <- read.csv("raw_data/interpolated_master_dat_10Dec24.csv")
#Paleo paper diagrams
#calculate p flux
int_master_dat <- int_master_dat %>% mutate(recalcitrant_o_p_flux=recalcitrant_o_p*dmar_loess,
labile_o_p_flux=labile_o_p*dmar_loess,
tp_results_flux=tp_results_mg_p_g*dmar_loess)
glimpse(int_master_dat)
#combine lutein+zeaxanthin
int_master_dat$lut_zea <- int_master_dat$lutein + int_master_dat$zea
View(int_master_dat)
## ----------------------------------- ##
# Housekeeping ----
## ----------------------------------- ##
rm(list=ls())
#interpolated master dat
int_master_dat <- read.csv("raw_data/interpolated_master_dat_10Dec24.csv")
glimpse(int_master_dat)
#select variables for algae strat diagram
paleo_prod <- int_master_dat %>% select(c(lake,year_loess,
chl_b,fuco,b_car,lutein,diato,allo,myxo,cantha,echine,
aul_subarctica,aul_ambigua,pse_elliptica,ast_formosa,tab_flocculosa,fra_crotonensis,sta_venter))
unique(paleo_prod$lake)
glimpse(paleo_prod)
#finger stratigraph
finger <- paleo_prod %>%
filter(lake=="finger")
glimpse(finger)
colnames(finger)
finger_plot <- strat.plot(finger[,3:18],yvar=finger$year_loess,
y.tks=seq(1860,2020,20),
plot.poly=T,plot.bar=T,col.bar="black",
srt.xlabel=30,title="Finger")
?strat.plot
strat.plot(finger[,3:18],yvar=finger$year_loess,
y.tks=seq(1860,2020,20),
plot.poly=T,plot.bar=T,col.bar="black",
srt.xlabel=30,title="Finger")
dev.off()
dev.off()
finger_plot
#install.packages(librarian)
librarian::shelf(tidyverse,rioja,tidypaleo)
theme_set(theme_paleo())
keji_lakes_plottable
glimpse(keji_lakes_plottable)
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
ggplot(aes(y=value,x=year_loess))+
geom_area()+
coord_flip()+
facet_abundanceh(vars(name),groups=vars(lake))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
ggplot(aes(y=value,x=year_loess))+
geom_area()+
coord_flip()+
facet_abundanceh(vars(name),grouping=vars(lake))
?facet_abundanceh
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
ggplot(aes(y=value,x=year_loess))+
geom_area()+
coord_flip()+
facet_geochem_wrap(vars(name),grouping=vars(lake))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
ggplot(aes(y=value,x=year_loess))+
geom_area()+
coord_flip()+
facet_geochem_gridh(vars(name),grouping=vars(lake))
#select variables for algae strat diagram
paleo_prod <- master_dat %>% select(c(lake,year_loess,
chl_b,fuco,b_car,lutein,diato,allo,myxo,cantha,echine,
aul_subarctica,aul_ambigua,pse_elliptica,ast_formosa,tab_flocculosa,fra_crotonensis,sta_venter))
#master dat
master_dat <- read.csv("Master dataset/WL_paleo_masterdataset_20Nov2024.csv")
#select variables for algae strat diagram
paleo_prod <- master_dat %>% select(c(lake,year_loess,
chl_b,fuco,b_car,lutein,diato,allo,myxo,cantha,echine,
aul_subarctica,aul_ambigua,pse_elliptica,ast_formosa,tab_flocculosa,fra_crotonensis,sta_venter))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
ggplot(aes(y=value,x=year_loess))+
geom_area()+
coord_flip()+
facet_geochem_gridh(vars(name),grouping=vars(lake))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
ggplot(aes(y=value,x=year_loess))+
geom_area(color="black",fill="gray")+
coord_flip()+
facet_geochem_gridh(vars(name),grouping=vars(lake))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
ggplot(aes(y=value,x=year_loess))+
geom_area(color="black",fill="gray")+
coord_flip()+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme(strip.text=element_text(angle=45))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
ggplot(aes(y=value,x=year_loess))+
geom_area(color="black",fill="gray")+
coord_flip()+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme(strip.text=element_text(angle=45,hjust=0))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
ggplot(aes(y=value,x=year_loess))+
geom_area(color="black",fill="gray")+
coord_flip()+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme(strip.text=element_text(angle=45,hjust=1))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
ggplot(aes(y=value,x=year_loess))+
geom_area(color="black",fill="gray")+
coord_flip()+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme(strip.text=element_text(angle=45,hjust=0))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
ggplot(aes(y=value,x=year_loess))+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
coord_flip()+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme(strip.text=element_text(angle=45,hjust=0))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
ggplot(aes(y=value,x=year_loess))+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
coord_flip()+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme(strip.text=element_text(angle=45))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
ggplot(aes(x=value,y=year_loess))+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme(strip.text=element_text(angle=45))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
ggplot(aes(y=value,x=year_loess))+
coord_flip()+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme(strip.text=element_text(angle=45))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
ggplot(aes(y=value,x=year_loess))+
coord_flip()+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme_classic()+
theme(strip.text=element_text(angle=45))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
ggplot(aes(y=value,x=year_loess))+
coord_flip()+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme_classic()+
theme(strip.text=element_text(angle=45),
strip.background=element_blank())
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
mutate(name = factor(name,
levels=c("chl_b","fuco","b_car","lut_zea","diato","allo","myxo","cantha","echine",
"aul_subarctica","aul_ambigua","pse_elliptica","ast_formosa","tab_flocculosa",
"fra_crotonensis","sta_venter"))) %>%
ggplot(aes(y=value,x=year_loess))+
coord_flip()+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme_classic()+
theme(strip.text=element_text(angle=45),
strip.background=element_blank())
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
pivot_longer(cols=chl_b:sta_venter) %>%
mutate(name = factor(name,
levels=c("chl_b","fuco","b_car","lut_zea","diato","allo","myxo","cantha","echine",
"aul_subarctica","aul_ambigua","pse_elliptica","ast_formosa","tab_flocculosa",
"fra_crotonensis","sta_venter")))
View(paleo_prod)
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
filter(if_all(chl_b:sta_venter,!is.na))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
filter(!if_all(chl_b:sta_venter,is.na))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
filter(!if_all(chl_b:sta_venter,is.na)) %>% #remove rows where all paleo data is NA
pivot_longer(cols=chl_b:sta_venter) %>%
mutate(name = factor(name,
levels=c("chl_b","fuco","b_car","lut_zea","diato","allo","myxo","cantha","echine",
"aul_subarctica","aul_ambigua","pse_elliptica","ast_formosa","tab_flocculosa",
"fra_crotonensis","sta_venter"))) %>%
ggplot(aes(y=value,x=year_loess))+
coord_flip()+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme_classic()+
theme(strip.text=element_text(angle=45),
strip.background=element_blank())
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
filter(!if_all(chl_b:sta_venter,is.na)) %>% #remove rows where all paleo data is NA
pivot_longer(cols=chl_b:sta_venter) %>%
mutate(name = factor(name,
levels=c("chl_b","fuco","b_car","lut_zea","diato","allo","myxo","cantha","echine",
"aul_subarctica","aul_ambigua","pse_elliptica","ast_formosa","tab_flocculosa",
"fra_crotonensis","sta_venter")))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
filter(!if_all(chl_b:sta_venter,is.na)) %>% #remove rows where all paleo data is NA
pivot_longer(cols=chl_b:sta_venter) %>%
mutate(name = factor(name,
levels=c("chl_b","fuco","b_car","lut_zea","diato","allo","myxo","cantha","echine",
"aul_subarctica","aul_ambigua","pse_elliptica","ast_formosa","tab_flocculosa",
"fra_crotonensis","sta_venter"))) %>%
glimpse()
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
filter(!if_all(chl_b:sta_venter,is.na)) %>% #remove rows where all paleo data is NA
pivot_longer(cols=chl_b:sta_venter) %>%
mutate(name = factor(name,
levels=c("chl_b","fuco","b_car","lut_zea","diato","allo","myxo","cantha","echine",
"aul_subarctica","aul_ambigua","pse_elliptica","ast_formosa","tab_flocculosa",
"fra_crotonensis","sta_venter"))) %>%
filter(!is.na(name))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
filter(!if_all(chl_b:sta_venter,is.na)) %>% #remove rows where all paleo data is NA
pivot_longer(cols=chl_b:sta_venter) %>%
mutate(name = factor(name,
levels=c("chl_b","fuco","b_car","lut_zea","diato","allo","myxo","cantha","echine",
"aul_subarctica","aul_ambigua","pse_elliptica","ast_formosa","tab_flocculosa",
"fra_crotonensis","sta_venter"))) %>%
filter(!is.na(name)) %>% #remove rows where "name" is NA
ggplot(aes(y=value,x=year_loess))+
coord_flip()+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme_classic()+
theme(strip.text=element_text(angle=45),
strip.background=element_blank())
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
filter(!if_all(chl_b:sta_venter,is.na)) %>% #remove rows where all paleo data is NA
pivot_longer(cols=chl_b:sta_venter) %>%
mutate(name = factor(name,
levels=c("chl_b","fuco","b_car","lut_zea","diato","allo","myxo","cantha","echine",
"aul_subarctica","aul_ambigua","pse_elliptica","ast_formosa","tab_flocculosa",
"fra_crotonensis","sta_venter"))) %>%
filter(!is.na(name)) %>% #remove rows where "name" is NA
ggplot(aes(y=value,x=year_loess))+
coord_flip()+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme_classic()+
theme(strip.text=element_text(angle=45),
strip.background=element_blank(),
axis.text.x=element_text(angle=90))
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
filter(!if_all(chl_b:sta_venter,is.na)) %>% #remove rows where all paleo data is NA
pivot_longer(cols=chl_b:sta_venter) %>%
mutate(name = factor(name,
levels=c("chl_b","fuco","b_car","lut_zea","diato","allo","myxo","cantha","echine",
"aul_subarctica","aul_ambigua","pse_elliptica","ast_formosa","tab_flocculosa",
"fra_crotonensis","sta_venter"))) %>%
filter(!is.na(name)) %>% #remove rows where "name" is NA
ggplot(aes(y=value,x=year_loess))+
coord_flip()+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme_classic()+
theme(strip.text=element_text(angle=45),
strip.background=element_blank(),
axis.text.x=element_text(angle=90),
axis.title=element_blank())
theme_paleo()
?theme_paleo()
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
filter(!if_all(chl_b:sta_venter,is.na)) %>% #remove rows where all paleo data is NA
pivot_longer(cols=chl_b:sta_venter) %>%
mutate(name = factor(name,
levels=c("chl_b","fuco","b_car","lut_zea","diato","allo","myxo","cantha","echine",
"aul_subarctica","aul_ambigua","pse_elliptica","ast_formosa","tab_flocculosa",
"fra_crotonensis","sta_venter"))) %>%
filter(!is.na(name)) %>% #remove rows where "name" is NA
ggplot(aes(y=value,x=year_loess))+
coord_flip()+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme_classic()+
theme(strip.text.top=element_text(angle=45,size=12),
strip.background=element_blank(),
axis.text.x=element_text(angle=90),
axis.title=element_blank())
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
filter(!if_all(chl_b:sta_venter,is.na)) %>% #remove rows where all paleo data is NA
pivot_longer(cols=chl_b:sta_venter) %>%
mutate(name = factor(name,
levels=c("chl_b","fuco","b_car","lut_zea","diato","allo","myxo","cantha","echine",
"aul_subarctica","aul_ambigua","pse_elliptica","ast_formosa","tab_flocculosa",
"fra_crotonensis","sta_venter"))) %>%
filter(!is.na(name)) %>% #remove rows where "name" is NA
ggplot(aes(y=value,x=year_loess))+
coord_flip()+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme_classic()+
theme(strip.text.x=element_text(angle=45,size=12),
strip.background=element_blank(),
axis.text.x=element_text(angle=90),
axis.title=element_blank())
paleo_prod %>%
mutate(lake = factor(lake,levels=c("dunnigan","finger","flame","wtwin","burnt","smoke","elbow","etwin"),
labels=c("Dunnigan","Finger","Flame","W. Twin","Burnt","Smoke","Elbow","E. Twin"))) %>%
filter(!if_all(chl_b:sta_venter,is.na)) %>% #remove rows where all paleo data is NA
pivot_longer(cols=chl_b:sta_venter) %>%
mutate(name = factor(name,
levels=c("chl_b","fuco","b_car","lut_zea","diato","allo","myxo","cantha","echine",
"aul_subarctica","aul_ambigua","pse_elliptica","ast_formosa","tab_flocculosa",
"fra_crotonensis","sta_venter"))) %>%
filter(!is.na(name)) %>% #remove rows where "name" is NA
ggplot(aes(y=value,x=year_loess))+
coord_flip()+
geom_area(color="black",fill="gray")+
geom_bar(stat="identity",width=0.5)+
facet_geochem_gridh(vars(name),grouping=vars(lake))+
theme_classic()+
theme(strip.text.x=element_text(angle=45,size=10),
strip.text.y=element_text(size=10),
strip.background=element_blank(),
axis.text.x=element_text(angle=90),
axis.title=element_blank())
